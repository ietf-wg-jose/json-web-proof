<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>JSON Proof Algorithms</title>
<meta content="Michael B. Jones" name="author">
<meta content="David Waite" name="author">
<meta content="Jeremie Miller" name="author">
<meta content="
       The JSON Proof Algorithms (JPA) specification registers cryptographic
algorithms and identifiers to be used with the JSON Web Proof, JSON Web
Key (JWK), and COSE specifications.  It defines IANA registries for
these identifiers. 
    " name="description">
<meta content="xml2rfc 3.29.0" name="generator">
<meta content="json" name="keyword">
<meta content="jose" name="keyword">
<meta content="zkp" name="keyword">
<meta content="jwp" name="keyword">
<meta content="jws" name="keyword">
<meta content="jpa" name="keyword">
<meta content="cbor" name="keyword">
<meta content="cose" name="keyword">
<meta content="draft-ietf-jose-json-proof-algorithms-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.29.0
    Python 3.12.11
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.8
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.4
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-jose-json-proof-algorithms.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">json-proof-algorithms</td>
<td class="right">July 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Jones, et al.</td>
<td class="center">Expires 8 January 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">jose</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-jose-json-proof-algorithms-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-07-07" class="published">7 July 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-01-08">8 January 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Jones</div>
<div class="org">Self-Issued Consulting</div>
</div>
<div class="author">
      <div class="author-name">D. Waite</div>
<div class="org">Ping Identity</div>
</div>
<div class="author">
      <div class="author-name">J. Miller</div>
<div class="org">Ping Identity</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">JSON Proof Algorithms</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The JSON Proof Algorithms (JPA) specification registers cryptographic
algorithms and identifiers to be used with the JSON Web Proof, JSON Web
Key (JWK), and COSE specifications.  It defines IANA registries for
these identifiers.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 8 January 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-background" class="internal xref">Background</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-algorithm-basics" class="internal xref">Algorithm Basics</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-issue" class="internal xref">Issue</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-confirm" class="internal xref">Confirm</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-present" class="internal xref">Present</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-verify" class="internal xref">Verify</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-algorithm-specifications" class="internal xref">Algorithm Specifications</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-single-use" class="internal xref">Single Use</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-jws-algorithm" class="internal xref">JWS Algorithm</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-holder-setup" class="internal xref">Holder Setup</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.3">
                    <p id="section-toc.1-1.6.2.1.2.3.1"><a href="#section-6.1.3" class="auto internal xref">6.1.3</a>.  <a href="#name-issuer-setup" class="internal xref">Issuer Setup</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.4">
                    <p id="section-toc.1-1.6.2.1.2.4.1"><a href="#section-6.1.4" class="auto internal xref">6.1.4</a>.  <a href="#name-signing-payloads" class="internal xref">Signing Payloads</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.5">
                    <p id="section-toc.1-1.6.2.1.2.5.1"><a href="#section-6.1.5" class="auto internal xref">6.1.5</a>.  <a href="#name-issuer-protected-header" class="internal xref">Issuer Protected Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.6">
                    <p id="section-toc.1-1.6.2.1.2.6.1"><a href="#section-6.1.6" class="auto internal xref">6.1.6</a>.  <a href="#name-payloads" class="internal xref">Payloads</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.7">
                    <p id="section-toc.1-1.6.2.1.2.7.1"><a href="#section-6.1.7" class="auto internal xref">6.1.7</a>.  <a href="#name-proof" class="internal xref">Proof</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.8">
                    <p id="section-toc.1-1.6.2.1.2.8.1"><a href="#section-6.1.8" class="auto internal xref">6.1.8</a>.  <a href="#name-presentation-protected-head" class="internal xref">Presentation Protected Header #{presentation-protected-header}</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.9">
                    <p id="section-toc.1-1.6.2.1.2.9.1"><a href="#section-6.1.9" class="auto internal xref">6.1.9</a>.  <a href="#name-presentation" class="internal xref">Presentation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.10">
                    <p id="section-toc.1-1.6.2.1.2.10.1"><a href="#section-6.1.10" class="auto internal xref">6.1.10</a>. <a href="#name-verification-of-presentatio" class="internal xref">Verification of Presentation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.11">
                    <p id="section-toc.1-1.6.2.1.2.11.1"><a href="#section-6.1.11" class="auto internal xref">6.1.11</a>. <a href="#name-jpa-registration" class="internal xref">JPA Registration</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-presentation-internal-repre" class="internal xref">Presentation Internal Representation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-bbs" class="internal xref">BBS</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="auto internal xref">6.3.1</a>.  <a href="#name-jpa-algorithms" class="internal xref">JPA Algorithms</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a href="#section-6.3.2" class="auto internal xref">6.3.2</a>.  <a href="#name-key-format" class="internal xref">Key Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.3">
                    <p id="section-toc.1-1.6.2.3.2.3.1"><a href="#section-6.3.3" class="auto internal xref">6.3.3</a>.  <a href="#name-issuance" class="internal xref">Issuance</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.4">
                    <p id="section-toc.1-1.6.2.3.2.4.1"><a href="#section-6.3.4" class="auto internal xref">6.3.4</a>.  <a href="#name-issuance-proof-verification" class="internal xref">Issuance Proof Verification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.5">
                    <p id="section-toc.1-1.6.2.3.2.5.1"><a href="#section-6.3.5" class="auto internal xref">6.3.5</a>.  <a href="#name-presentation-2" class="internal xref">Presentation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.6">
                    <p id="section-toc.1-1.6.2.3.2.6.1"><a href="#section-6.3.6" class="auto internal xref">6.3.6</a>.  <a href="#name-presentation-verification" class="internal xref">Presentation Verification</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-message-authentication-code" class="internal xref">Message Authentication Code</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.1">
                    <p id="section-toc.1-1.6.2.4.2.1.1"><a href="#section-6.4.1" class="auto internal xref">6.4.1</a>.  <a href="#name-holder-setup-2" class="internal xref">Holder Setup</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.2">
                    <p id="section-toc.1-1.6.2.4.2.2.1"><a href="#section-6.4.2" class="auto internal xref">6.4.2</a>.  <a href="#name-issuer-setup-2" class="internal xref">Issuer Setup</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.3">
                    <p id="section-toc.1-1.6.2.4.2.3.1"><a href="#section-6.4.3" class="auto internal xref">6.4.3</a>.  <a href="#name-combined-mac-representation" class="internal xref">Combined MAC Representation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.4">
                    <p id="section-toc.1-1.6.2.4.2.4.1"><a href="#section-6.4.4" class="auto internal xref">6.4.4</a>.  <a href="#name-issuer-protected-header-2" class="internal xref">Issuer Protected Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.5">
                    <p id="section-toc.1-1.6.2.4.2.5.1"><a href="#section-6.4.5" class="auto internal xref">6.4.5</a>.  <a href="#name-issuer-proof" class="internal xref">Issuer Proof</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.6">
                    <p id="section-toc.1-1.6.2.4.2.6.1"><a href="#section-6.4.6" class="auto internal xref">6.4.6</a>.  <a href="#name-presentation-protected-heade" class="internal xref">Presentation Protected Header</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.7">
                    <p id="section-toc.1-1.6.2.4.2.7.1"><a href="#section-6.4.7" class="auto internal xref">6.4.7</a>.  <a href="#name-presentation-proof" class="internal xref">Presentation Proof</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.8">
                    <p id="section-toc.1-1.6.2.4.2.8.1"><a href="#section-6.4.8" class="auto internal xref">6.4.8</a>.  <a href="#name-verification-of-the-present" class="internal xref">Verification of the Presentation Proof</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4.2.9">
                    <p id="section-toc.1-1.6.2.4.2.9.1"><a href="#section-6.4.9" class="auto internal xref">6.4.9</a>.  <a href="#name-jpa-registration-2" class="internal xref">JPA Registration</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-json-web-proof-algorithms-r" class="internal xref">JSON Web Proof Algorithms Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.1">
                    <p id="section-toc.1-1.8.2.1.2.1.1"><a href="#section-8.1.1" class="auto internal xref">8.1.1</a>.  <a href="#name-registration-template" class="internal xref">Registration Template</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2">
                    <p id="section-toc.1-1.8.2.1.2.2.1"><a href="#section-8.1.2" class="auto internal xref">8.1.2</a>.  <a href="#name-initial-registry-contents" class="internal xref">Initial Registry Contents</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2.2.1">
                        <p id="section-toc.1-1.8.2.1.2.2.2.1.1"><a href="#section-8.1.2.1" class="auto internal xref">8.1.2.1</a>.  <a href="#name-single-use-jwp-using-es256-" class="internal xref">Single-Use JWP using ES256 Algorithm</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2.2.2">
                        <p id="section-toc.1-1.8.2.1.2.2.2.2.1"><a href="#section-8.1.2.2" class="auto internal xref">8.1.2.2</a>.  <a href="#name-single-use-jwp-using-es384-" class="internal xref">Single-Use JWP using ES384 Algorithm</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2.2.3">
                        <p id="section-toc.1-1.8.2.1.2.2.2.3.1"><a href="#section-8.1.2.3" class="auto internal xref">8.1.2.3</a>.  <a href="#name-single-use-jwp-using-es512-" class="internal xref">Single-Use JWP using ES512 Algorithm</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2.2.4">
                        <p id="section-toc.1-1.8.2.1.2.2.2.4.1"><a href="#section-8.1.2.4" class="auto internal xref">8.1.2.4</a>.  <a href="#name-bbs-using-sha-256-algorithm" class="internal xref">BBS using SHA-256 Algorithm</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2.2.5">
                        <p id="section-toc.1-1.8.2.1.2.2.2.5.1"><a href="#section-8.1.2.5" class="auto internal xref">8.1.2.5</a>.  <a href="#name-mac-h256-algorithm" class="internal xref">MAC-H256 Algorithm</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2.2.6">
                        <p id="section-toc.1-1.8.2.1.2.2.2.6.1"><a href="#section-8.1.2.6" class="auto internal xref">8.1.2.6</a>.  <a href="#name-mac-h384-algorithm" class="internal xref">MAC-H384 Algorithm</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2.2.7">
                        <p id="section-toc.1-1.8.2.1.2.2.2.7.1"><a href="#section-8.1.2.7" class="auto internal xref">8.1.2.7</a>.  <a href="#name-mac-h512-algorithm" class="internal xref">MAC-H512 Algorithm</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2.2.8">
                        <p id="section-toc.1-1.8.2.1.2.2.2.8.1"><a href="#section-8.1.2.8" class="auto internal xref">8.1.2.8</a>.  <a href="#name-mac-k25519-algorithm" class="internal xref">MAC-K25519 Algorithm</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2.2.9">
                        <p id="section-toc.1-1.8.2.1.2.2.2.9.1"><a href="#section-8.1.2.9" class="auto internal xref">8.1.2.9</a>.  <a href="#name-mac-k448-algorithm" class="internal xref">MAC-K448 Algorithm</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2.2.10">
                        <p id="section-toc.1-1.8.2.1.2.2.2.10.1"><a href="#section-8.1.2.10" class="auto internal xref">8.1.2.10</a>. <a href="#name-mac-h256k-algorithm" class="internal xref">MAC-H256K Algorithm</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-example-jwps" class="internal xref">Example JWPs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-example-json-serialized-sin" class="internal xref">Example JSON-Serialized Single-Use JWP</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-example-cbor-serialized-sin" class="internal xref">Example CBOR-Serialized Single-Use CPT</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-example-bbs-jwp" class="internal xref">Example BBS JWP</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-example-mac-jwp" class="internal xref">Example MAC JWP</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The JSON Web Proof (JWP) <span>[<a href="#I-D.ietf-jose-json-web-proof" class="cite xref">I-D.ietf-jose-json-web-proof</a>]</span> draft
establishes a new secure container format that supports selective
disclosure and unlinkability using Zero-Knowledge Proofs (ZKPs) or other
cryptographic algorithms.<a href="#section-1-1" class="pilcrow">¶</a></p>
<blockquote id="section-1-2">
        <p id="section-1-2.1">Editor's Note: This draft is still early and incomplete.  There will
be significant changes to the algorithms as currently defined here.
Please do not use any of these definitions or examples for anything
except personal experimentation and learning.  Contributions and
feedback are welcomed at
<a href="https://github.com/ietf-wg-jose/json-web-proof">https://github.com/ietf-wg-jose/json-web-proof</a>.<a href="#section-1-2.1" class="pilcrow">¶</a></p>
</blockquote>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
"OPTIONAL" in this document are to be interpreted as described in BCP 14
<span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all
capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The roles of "issuer", "holder", and "verifier" are used as defined by
the VC Data Model <span>[<a href="#VC-DATA-MODEL-2.0" class="cite xref">VC-DATA-MODEL-2.0</a>]</span>.  The term "presentation" is also
used as defined by this source, but the term "credential" is avoided in
this specification to minimize confusion with other definitions.<a href="#section-2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-3">
      <h2 id="name-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-3-1">The terms "JSON Web Signature (JWS)", "Base64url Encoding", "Header
Parameter", "JOSE Header", "JWS Payload", "JWS Signature", and "JWS
Protected Header" are defined by <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The terms "JSON Web Proof (JWP)", "JWP Payload", "JWP Proof", and "JWP
Protected Header" are defined by <span>[<a href="#I-D.ietf-jose-json-web-proof" class="cite xref">I-D.ietf-jose-json-web-proof</a>]</span>.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">These terms are defined by this specification:<a href="#section-3-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-3-4">
        <dt id="section-3-4.1">Stable Key:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.2">An asymmetric key-pair used by an issuer that is also shared via an
out-of-band mechanism to a verifier to validate the signature.<a href="#section-3-4.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.3">Ephemeral Key:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.4">An asymmetric key-pair that is generated for one-time use by an issuer
and never stored or used again outside of the creation of a single
JWP.<a href="#section-3-4.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-4.5">Presentation Key:</dt>
        <dd style="margin-left: 1.5em" id="section-3-4.6">An asymmetric key-pair that is generated by a holder and used to
ensure that a presentation is not able to be replayed by any other
party.<a href="#section-3-4.6" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="background">
<section id="section-4">
      <h2 id="name-background">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-background" class="section-name selfRef">Background</a>
      </h2>
<p id="section-4-1">JWP defines a container binding together a protected header, one or more
payloads, and a cryptographic proof.  It does not define any details
about the interactions between an application and the cryptographic
libraries that implement proof-supporting algorithms.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Due to the nature of ZKPs, this specification also documents the subtle
but important differences in proof algorithms versus those defined by
the JSON Web Algorithms <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span>.  These differences help support more
advanced capabilities such as blinded signatures and predicate proofs.<a href="#section-4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="algorithm-basics">
<section id="section-5">
      <h2 id="name-algorithm-basics">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-algorithm-basics" class="section-name selfRef">Algorithm Basics</a>
      </h2>
<p id="section-5-1">The four principal interactions that every proof algorithm MUST support
are <a href="#issue">issue</a>, <a href="#confirm">confirm</a>, <a href="#present">present</a>, and
<a href="#verify">verify</a>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="issue">
<section id="section-5.1">
        <h3 id="name-issue">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-issue" class="section-name selfRef">Issue</a>
        </h3>
<p id="section-5.1-1">The JWP is first created as the output of a JPA's <code>issue</code> operation.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Every algorithm MUST support a JSON issuer protected header along with
one or more octet string payloads.  The algorithm MAY support using
additional items provided by the holder for issuance such as blinded
payloads, keys for replay prevention, etc.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">All algorithms MUST provide integrity protection for the issuer header
and all payloads and MUST specify all digest and/or hash2curve methods
used.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="confirm">
<section id="section-5.2">
        <h3 id="name-confirm">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-confirm" class="section-name selfRef">Confirm</a>
        </h3>
<p id="section-5.2-1">Performed by the holder to validate that the issued JWP is correctly
formed and protected.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Each algorithm MAY support using additional input items options, such as
those sent to the issuer for issuance.  After confirmation, an algorithm
MAY return a modified JWP for serialized storage without the local state
(such as with blinded payloads now unblinded).<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">The algorithm MUST fully verify the issued proof value against the
issuer protected header and all payloads.  If given a presented JWP
instead of an issued one, the confirm process MUST return an error.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="present">
<section id="section-5.3">
        <h3 id="name-present">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-present" class="section-name selfRef">Present</a>
        </h3>
<p id="section-5.3-1">Used to apply any selective disclosure choices and perform any
unlinkability transformations, as well as to show binding.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">An algorithm MAY support additional input options from the requesting
party, such as for predicate proofs and verifiable computation requests.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">Every algorithm MUST support the ability to hide any or all payloads.
It MUST always include the issuer protected header unmodified in the
presentation.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">The algorithm MUST replace the issued proof value and generate a new
presented proof value.  It also MUST include a new presentation
protected header that provides replay protection.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verify">
<section id="section-5.4">
        <h3 id="name-verify">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-verify" class="section-name selfRef">Verify</a>
        </h3>
<p id="section-5.4-1">Performed by the verifier to verify the protected headers along with any
disclosed payloads and/or assertions about them from the proving party,
while also verifying they are the same payloads and ordering as
witnessed by the issuer.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">The algorithm MUST verify the integrity of all disclosed payloads and
MUST also verify the integrity of both the issuer and presentation
protected headers.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">If the presented proof contains any assertions about the hidden
payloads, the algorithm MUST also verify all of those assertions.  It
MAY support additional options, such as those sent to the holder to
generate the presentation.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<p id="section-5.4-4">If given an issued JWP for verification, the algorithm MUST return an
error.<a href="#section-5.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="algorithm-specifications">
<section id="section-6">
      <h2 id="name-algorithm-specifications">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-algorithm-specifications" class="section-name selfRef">Algorithm Specifications</a>
      </h2>
<p id="section-6-1">This section defines how to use specific algorithms for JWPs.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="single-use">
<section id="section-6.1">
        <h3 id="name-single-use">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-single-use" class="section-name selfRef">Single Use</a>
        </h3>
<p id="section-6.1-1">The Single Use (SU) algorithm is based on composing multiple traditional
asymmetric signatures into a single JWP proof.  It enables a very simple
form of selective disclosure without requiring any advanced
cryptographic techniques.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">It does not support unlinkability if the same JWP is presented multiple
times, therefore when privacy is required the holder will need to
interact with the issuer again to receive new single-use JWPs
(dynamically or in batches).<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<div id="jws-algorithm">
<section id="section-6.1.1">
          <h4 id="name-jws-algorithm">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-jws-algorithm" class="section-name selfRef">JWS Algorithm</a>
          </h4>
<p id="section-6.1.1-1">The Single Use algorithm uses multiple signing keys to protect the
protected header as well as individual payloads of an Issued JWP.  The
issuer uses a stable public key to sign each protected header, and a
per-JWP ephemeral key (conveyed within the protected header) to protect
the individual payloads.  These signatures are all created using the
same Asymmetric Algorithm, with the JOSE and COSE name/label of this
algorithm being part of registration for a fully-specified Single Use
algorithm identifier.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2">The issuer protected header also conveys a holder presentation key, an
ephemeral asymmetric key meant to only be used for presenting a single
JWP.  The fully-specified algorithm the holder must use for
presentations is also included.  This algorithm MAY be different from
the algorithm used by the issuer.<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1.1-3">The chosen algorithms MUST be asymmetric signing algorithms, so that
each signature can be verified without sharing any private values
between the parties.<a href="#section-6.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="holder-setup">
<section id="section-6.1.2">
          <h4 id="name-holder-setup">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-holder-setup" class="section-name selfRef">Holder Setup</a>
          </h4>
<p id="section-6.1.2-1">In order to support the protection of a presentation by a holder to a
verifier, the holder MUST use a Presentation Key during the issuance and
the presentation of every Single Use JWP.  This Presentation Key MUST be
generated and used for only one JWP.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2">The issuer MUST verify that the holder has possession of this key.  The
holder-issuer communication to exchange this information is out of scope
of this specification, but can be accomplished by the holder using this
key to generate a JWS that signs a value the issuer can verify as
unique.<a href="#section-6.1.2-2" class="pilcrow">¶</a></p>
<p id="section-6.1.2-3">The issuer MUST determine an appropriate holder presentation algorithm
corresponding to the presentation key.  If the holder and verifier
cannot be assumed to know this algorithm is the appropriate choice for a
given presentation key, this value MUST be conveyed in the <code>hpa</code> issuer
protected header.<a href="#section-6.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer-setup">
<section id="section-6.1.3">
          <h4 id="name-issuer-setup">
<a href="#section-6.1.3" class="section-number selfRef">6.1.3. </a><a href="#name-issuer-setup" class="section-name selfRef">Issuer Setup</a>
          </h4>
<p id="section-6.1.3-1">To create a Single Use JWP, the issuer first generates a unique
Ephemeral Key using the selected internal algorithm.  This key-pair will
be used to sign each of the payloads of a single JWP and then discarded.<a href="#section-6.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signing-payloads">
<section id="section-6.1.4">
          <h4 id="name-signing-payloads">
<a href="#section-6.1.4" class="section-number selfRef">6.1.4. </a><a href="#name-signing-payloads" class="section-name selfRef">Signing Payloads</a>
          </h4>
<p id="section-6.1.4-1">Each individual payload is signed using the selected internal algorithm
using the Ephemeral Key.<a href="#section-6.1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer-protected-header">
<section id="section-6.1.5">
          <h4 id="name-issuer-protected-header">
<a href="#section-6.1.5" class="section-number selfRef">6.1.5. </a><a href="#name-issuer-protected-header" class="section-name selfRef">Issuer Protected Header</a>
          </h4>
<p id="section-6.1.5-1">The Issuer's Ephemeral Key MUST be included via the Proof Key header
parameter.<a href="#section-6.1.5-1" class="pilcrow">¶</a></p>
<p id="section-6.1.5-2">The Holder's Presentation Key MUST be included via the Presentation Key
header parameter.<a href="#section-6.1.5-2" class="pilcrow">¶</a></p>
<p id="section-6.1.5-3">The Holder's Presentation Algorithm MUST be included via the Holder
Presentation Algorithm header parameter unless there is another way for
the holder and verifier to unambiguously determine the appropriate
algorithm to use.<a href="#section-6.1.5-3" class="pilcrow">¶</a></p>
<p id="section-6.1.5-4">The Issuer Protected Header is signed using the appropriate internal
signing algorithm for the given fully-specified single use algorithm,
using the issuer's Stable Key.<a href="#section-6.1.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="payloads">
<section id="section-6.1.6">
          <h4 id="name-payloads">
<a href="#section-6.1.6" class="section-number selfRef">6.1.6. </a><a href="#name-payloads" class="section-name selfRef">Payloads</a>
          </h4>
<p id="section-6.1.6-1">Each JWP payload is processed in order and signed using the given JWA
using the issuer's Ephemeral Key.<a href="#section-6.1.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="proof">
<section id="section-6.1.7">
          <h4 id="name-proof">
<a href="#section-6.1.7" class="section-number selfRef">6.1.7. </a><a href="#name-proof" class="section-name selfRef">Proof</a>
          </h4>
<p id="section-6.1.7-1">The proof value is an octet string array.  The first entry is the octet
string of the issuer protected header signature, with an additional
entry for each payload signature.<a href="#section-6.1.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="presentation-protected-header-presentation-protected-header">
<section id="section-6.1.8">
          <h4 id="name-presentation-protected-head">
<a href="#section-6.1.8" class="section-number selfRef">6.1.8. </a><a href="#name-presentation-protected-head" class="section-name selfRef">Presentation Protected Header #{presentation-protected-header}</a>
          </h4>
<p id="section-6.1.8-1">To generate a new presentation, the holder first creates a presentation
protected header that is specific to the verifier being presented to.
This header MUST contain a parameter that both the holder and verifier
trust as being unique and non-replayable.  Use of the <code>nonce</code> header
parameter is RECOMMENDED for this purpose.<a href="#section-6.1.8-1" class="pilcrow">¶</a></p>
<p id="section-6.1.8-2">This specification registers the <code>nonce</code> header parameter for the
presentation protected header that contains a string value either
generated by the verifier or derived from values provided by the
verifier.  When present, the verifier MUST ensure the nonce value
matches during verification.<a href="#section-6.1.8-2" class="pilcrow">¶</a></p>
<p id="section-6.1.8-3">The presentation protected header MAY contain other header parameters
that are either provided by the verifier or by the holder.  These
presentation header parameters SHOULD NOT contain values that are common
across multiple presentations and SHOULD be unique to a single
presentation and verifier.<a href="#section-6.1.8-3" class="pilcrow">¶</a></p>
<p id="section-6.1.8-4">The presentation protected header MUST contain the same Algorithm
protected header as the issuer protected header.  The Holder
Presentation Algorithm protected header MUST NOT be included.<a href="#section-6.1.8-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="presentation">
<section id="section-6.1.9">
          <h4 id="name-presentation">
<a href="#section-6.1.9" class="section-number selfRef">6.1.9. </a><a href="#name-presentation" class="section-name selfRef">Presentation</a>
          </h4>
<p id="section-6.1.9-1">The holder derives a new proof as part of presentation.  The holder will
also use these components to generate a <a href="#presentation-internal-representation">presentation internal
representation</a>.  The number of
components depends on the number of payloads which are being disclosed
in the presented JWP.<a href="#section-6.1.9-1" class="pilcrow">¶</a></p>
<p id="section-6.1.9-2">The first proof component will be the signature over the issuer
protected header made by the issuer's Stable Key.<a href="#section-6.1.9-2" class="pilcrow">¶</a></p>
<p id="section-6.1.9-3">For each payload which is to be disclosed, the corresponding payload
signature (from the issued JWP) is included as a subsequent proof
component.  If the payload is being omitted, the corresponding payload
signature is omitted from the proof components.<a href="#section-6.1.9-3" class="pilcrow">¶</a></p>
<p id="section-6.1.9-4">The holder protected header, issuer protected header, payload slots
(distinguishing which are being disclosed) and these proof components
are inputs to determine the presentation internal representation.<a href="#section-6.1.9-4" class="pilcrow">¶</a></p>
<p id="section-6.1.9-5">The holder's signature over the presentation internal representation
(using the holder's private key and the holder presentation algorithm)
is then included as one additional proof component in the final
presentation.<a href="#section-6.1.9-5" class="pilcrow">¶</a></p>
<p id="section-6.1.9-6">For example, if only the second and fifth of five payloads are being
disclosed, then the proof at this stage will consist of three values:<a href="#section-6.1.9-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-6.1.9-7">
<li id="section-6.1.9-7.1">The issuer's signature over the issuer protected header<a href="#section-6.1.9-7.1" class="pilcrow">¶</a>
</li>
            <li id="section-6.1.9-7.2">The payload signature corresponding to the second payload<a href="#section-6.1.9-7.2" class="pilcrow">¶</a>
</li>
            <li id="section-6.1.9-7.3">The payload signature corresponding to the fifth payload.<a href="#section-6.1.9-7.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-6.1.9-8">The presentation internal representation would be calculated with these
three proof components, while the final presentation would have an
additional fourth component containing the signature using the holder's
private key.<a href="#section-6.1.9-8" class="pilcrow">¶</a></p>
<p id="section-6.1.9-9">Since the individual signatures in the proof value are unique and remain
unchanged across multiple presentations, a Single Use JWP SHOULD only be
presented a single time to each verifier in order for the holder to
remain unlinkable across multiple presentations.<a href="#section-6.1.9-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verification-of-presentation">
<section id="section-6.1.10">
          <h4 id="name-verification-of-presentatio">
<a href="#section-6.1.10" class="section-number selfRef">6.1.10. </a><a href="#name-verification-of-presentatio" class="section-name selfRef">Verification of Presentation</a>
          </h4>
<p id="section-6.1.10-1">Verification is performed using the following steps.<a href="#section-6.1.10-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-6.1.10-2">
<li id="section-6.1.10-2.1">Check that the number of proof components is appropriate for the number of
disclosed payloads.  There MUST be two more proof components than
disclosed payloads.<a href="#section-6.1.10-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-6.1.10-2.2">Verify the first proof component is a valid signature over issuer
protected header octets, using the issuer's stable key.<a href="#section-6.1.10-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-6.1.10-2.3">Extract the presentation key and holder presentation algorithm (if
present) from the issuer protected header.<a href="#section-6.1.10-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-6.1.10-2.4">Omitting the final payload component, calculate the <a href="#presentation-internal-representation">presentation
internal representation</a>.<a href="#section-6.1.10-2.4" class="pilcrow">¶</a>
</li>
            <li id="section-6.1.10-2.5">Verify the final proof component is a valid signature over the
presentation internal binary form, using the holder's presentation
key and the extracted (or otherwise determined) holder presentation
algorithm.<a href="#section-6.1.10-2.5" class="pilcrow">¶</a>
</li>
            <li id="section-6.1.10-2.6">For each remaining proof component, verify they form a valid
signature over each disclosed payload in sequence, using the issuer's
ephemeral key.<a href="#section-6.1.10-2.6" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="SU-registration">
<section id="section-6.1.11">
          <h4 id="name-jpa-registration">
<a href="#section-6.1.11" class="section-number selfRef">6.1.11. </a><a href="#name-jpa-registration" class="section-name selfRef">JPA Registration</a>
          </h4>
<p id="section-6.1.11-1">The proposed JWP <code>alg</code> value is of the format "SU-" appended with the
relevant JWS <code>alg</code> value for the chosen public and ephemeral key-pair
algorithm, for example "SU-ES256".<a href="#section-6.1.11-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="presentation-internal-representation">
<section id="section-6.2">
        <h3 id="name-presentation-internal-repre">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-presentation-internal-repre" class="section-name selfRef">Presentation Internal Representation</a>
        </h3>
<p id="section-6.2-1">Some algorithms (such as Single use and MAC) use a holder key to provide
integrity over the presentation.  For these algorithms, an internal
binary form of the presentation must be generated both for signing by
the holder, and for verification by the verifier.  Other algorithms MAY
use this same form for consistency.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The instructions for creating this binary representation will also
create well-formed CBOR, although this data is not meant to be shared
outside the implementing algorithm.  Instead, it focuses on simplicity
of generation by the holder and verifier implementations.  Although CBOR
has multiple representations of the same underlying information, this
same octet string MUST be generated by an implementation.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">When a length or count is added by the steps below, it is added as its 8
byte, network-ordered representation.  For example, the length of a
1,234 byte payload would have a length representation of
<code>0x00 00 00 00 00 00 04 D2</code>.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">The binary representation is created by appending data into a single
octet string in the following order:<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2-5">
<li id="section-6.2-5.1">
            <code>0x84 5B</code><a href="#section-6.2-5.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-5.2">The length and octets of the presentation protected header<a href="#section-6.2-5.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-5.3">
            <code>0x5B</code><a href="#section-6.2-5.3" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-5.4">The length and octets of the issuer protected header<a href="#section-6.2-5.4" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-5.5">
            <code>0x9B</code><a href="#section-6.2-5.5" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-5.6">The number of payload slots in the issued message<a href="#section-6.2-5.6" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-5.7">
            <p id="section-6.2-5.7.1">For each payload representation:<a href="#section-6.2-5.7.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-5.7.2.1">If the payload is being omitted, the value <code>0xF6</code><a href="#section-6.2-5.7.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-5.7.2.2">
                <p id="section-6.2-5.7.2.2.1">Otherwise:<a href="#section-6.2-5.7.2.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-6.2-5.7.2.2.2">
<li id="section-6.2-5.7.2.2.2.1">
                    <code>0x5B</code><a href="#section-6.2-5.7.2.2.2.1" class="pilcrow">¶</a>
</li>
                  <li id="section-6.2-5.7.2.2.2.2">The length and octets of the payload<a href="#section-6.2-5.7.2.2.2.2" class="pilcrow">¶</a>
</li>
                </ol>
</li>
            </ul>
</li>
          <li id="section-6.2-5.8">
            <p id="section-6.2-5.8.1"><code>0x9B</code><a href="#section-6.2-5.8.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-5.9">
            <p id="section-6.2-5.9.1">The number of proof components as specified by the algorithm<a href="#section-6.2-5.9.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-5.10">
            <p id="section-6.2-5.10.1">For each proof component, append:<a href="#section-6.2-5.10.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-6.2-5.10.2">
<li id="section-6.2-5.10.2.1">
                <code>0x5B</code><a href="#section-6.2-5.10.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-6.2-5.10.2.2">The length and octets of the proof component<a href="#section-6.2-5.10.2.2" class="pilcrow">¶</a>
</li>
            </ol>
</li>
        </ol>
</section>
</div>
<div id="bbs">
<section id="section-6.3">
        <h3 id="name-bbs">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-bbs" class="section-name selfRef">BBS</a>
        </h3>
<p id="section-6.3-1">The BBS Signature Scheme <span>[<a href="#I-D.irtf-cfrg-bbs-signatures" class="cite xref">I-D.irtf-cfrg-bbs-signatures</a>]</span> is under
active development within the CRFG.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">This algorithm supports both selective disclosure and unlinkability,
enabling the holder to generate multiple presentations from one issued
JWP without a verifier being able to correlate those presentations
together based on the proof.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<div id="BBS-registration">
<section id="section-6.3.1">
          <h4 id="name-jpa-algorithms">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-jpa-algorithms" class="section-name selfRef">JPA Algorithms</a>
          </h4>
<p id="section-6.3.1-1">The <code>BBS</code> algorithm corresponds to a ciphersuite identifier of
<code>BBS_BLS12381G1_XMD:SHA-256_SSWU_RO_</code>.<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-format">
<section id="section-6.3.2">
          <h4 id="name-key-format">
<a href="#section-6.3.2" class="section-number selfRef">6.3.2. </a><a href="#name-key-format" class="section-name selfRef">Key Format</a>
          </h4>
<p id="section-6.3.2-1">The key used for the <code>BBS</code> algorithm is an elliptic curve-based key
pair, specifically against the G_2 subgroup of a pairing friendly curve.
Additional details on key generation can be found in
<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bbs-signatures-08#appendix-Section%203.4" class="relref">Section 3.4</a>.  The JWK and Cose Key
Object representations of the key are detailed in
<span>[<a href="#I-D.ietf-cose-bls-key-representations" class="cite xref">I-D.ietf-cose-bls-key-representations</a>]</span>.<a href="#section-6.3.2-1" class="pilcrow">¶</a></p>
<p id="section-6.3.2-2">There is no additional holder presentation key necessary for
presentation proofs.<a href="#section-6.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuance">
<section id="section-6.3.3">
          <h4 id="name-issuance">
<a href="#section-6.3.3" class="section-number selfRef">6.3.3. </a><a href="#name-issuance" class="section-name selfRef">Issuance</a>
          </h4>
<p id="section-6.3.3-1">Issuance is performed using the <code>Sign</code> operation from
<span><a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bbs-signatures-08#section-3.5.1" class="relref">Section 3.5.1</a> of [<a href="#I-D.irtf-cfrg-bbs-signatures" class="cite xref">I-D.irtf-cfrg-bbs-signatures</a>]</span>.  This operation
utilizes the issuer's BLS12-381 G2 key pair as <code>SK</code> and <code>PK</code>, along with
desired protected header octets as <code>header</code>, and the array of payload
octet string as <code>messages</code>.<a href="#section-6.3.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3.3-2">The octets resulting from this operation form a single octet string in
the issuance proof array, to be used along with the protected header and
payloads to serialize the JWP.<a href="#section-6.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuance-proof-verification">
<section id="section-6.3.4">
          <h4 id="name-issuance-proof-verification">
<a href="#section-6.3.4" class="section-number selfRef">6.3.4. </a><a href="#name-issuance-proof-verification" class="section-name selfRef">Issuance Proof Verification</a>
          </h4>
<p id="section-6.3.4-1">Holder verification of the signature on issuance form is performed using
the <code>Verify</code> operation from [@!I-D.irtf-cfrg-bbs-signatures, section
3.5.2].<a href="#section-6.3.4-1" class="pilcrow">¶</a></p>
<p id="section-6.3.4-2">This operation utilizes the issuer's public key as <code>PK</code>, the proof as
<code>signature</code>, the protected header octets as <code>header</code> and the array of
payload octets as <code>messages</code>.<a href="#section-6.3.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="presentation-1">
<section id="section-6.3.5">
          <h4 id="name-presentation-2">
<a href="#section-6.3.5" class="section-number selfRef">6.3.5. </a><a href="#name-presentation-2" class="section-name selfRef">Presentation</a>
          </h4>
<p id="section-6.3.5-1">Derivation of a presentation is done by the holder using the <code>ProofGen</code>
operation from <span><a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bbs-signatures-08#section-3.5.3" class="relref">Section 3.5.3</a> of [<a href="#I-D.irtf-cfrg-bbs-signatures" class="cite xref">I-D.irtf-cfrg-bbs-signatures</a>]</span>.<a href="#section-6.3.5-1" class="pilcrow">¶</a></p>
<p id="section-6.3.5-2">This operation utilizes the issuer's public key as <code>PK</code>, the issuer
protected header as <code>header</code>, the issuance proof as <code>signature</code>, the
issuance payloads as <code>messages</code>, and the holder's presentation protected
header as <code>ph</code>.<a href="#section-6.3.5-2" class="pilcrow">¶</a></p>
<p id="section-6.3.5-3">The operation also takes a vector of indexes into <code>messages</code>, describing
which payloads the holder wishes to disclose.  All payloads are required
for proof generation, but only these indicated payloads will be required
to be disclosed for later proof verification.<a href="#section-6.3.5-3" class="pilcrow">¶</a></p>
<p id="section-6.3.5-4">The output of this operation is the presentation proof, as a single
octet string.<a href="#section-6.3.5-4" class="pilcrow">¶</a></p>
<p id="section-6.3.5-5">Presentation serialization leverages the two protected headers and
presentation proof, along with the disclosed payloads.  Non-disclosed
payloads are represented with the absent value of <code>null</code> in CBOR
serialization and a zero-length string in compact serialization.<a href="#section-6.3.5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="presentation-verification">
<section id="section-6.3.6">
          <h4 id="name-presentation-verification">
<a href="#section-6.3.6" class="section-number selfRef">6.3.6. </a><a href="#name-presentation-verification" class="section-name selfRef">Presentation Verification</a>
          </h4>
<p id="section-6.3.6-1">Verification of a presentation is done by the verifier using the
<code>ProofVerify</code> operation from [@!I-D.irtf-cfrg-bbs-signatures, Section
3.5.4].<a href="#section-6.3.6-1" class="pilcrow">¶</a></p>
<p id="section-6.3.6-2">This operation utilizes the issuer's public key as <code>PK</code>, the issuer
protected header as <code>header</code>, the issuance proof as <code>signature</code>, the
holder's presentation protected header as <code>ph</code>, and the payloads as
<code>disclosed_messages</code>.<a href="#section-6.3.6-2" class="pilcrow">¶</a></p>
<p id="section-6.3.6-3">In addition, the <code>disclosed_indexes</code> scalar array is calculated from the
payloads provided.  Values disclosed in the presented payloads have a
zero-based index in this array, while the indices of absent payloads are
omitted.<a href="#section-6.3.6-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="message-authentication-code">
<section id="section-6.4">
        <h3 id="name-message-authentication-code">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-message-authentication-code" class="section-name selfRef">Message Authentication Code</a>
        </h3>
<p id="section-6.4-1">The Message Authentication Code (MAC) JPA uses a MAC to both generate
ephemeral secrets and to authenticate payloads, along with an
asymmetric signature to provide integrity to the issued JWP.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">The holder can manipulate which payloads are disclosed from the issued
JWP, and uses the holder Presentation Key to create a presentation.  The
signature created from the Holder Presentation Key MAY use a different
algorithm than the Issuer used to sign the issued form.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">Like the Single Use algorithm family, it also does not support
unlinkability if the same JWP is presented multiple times and requires
an individually issued JWP for each presentation in order to fully
protect privacy.  When compared to the JWS approach, using a MAC
requires less computation but can result in potentially larger
presentation proof values.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4-4">The design is intentionally minimal and only involves using a single
standardized MAC method instead of a mix of MAC/hash methods or a custom
hash-based construct.  It is able to use any published cryptographic MAC
method such as HMAC <span>[<a href="#RFC2104" class="cite xref">RFC2104</a>]</span> or
<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf">KMAC</a>.
It uses traditional public key-based signatures to verify the
authenticity of the issuer and holder.<a href="#section-6.4-4" class="pilcrow">¶</a></p>
<div id="holder-setup-1">
<section id="section-6.4.1">
          <h4 id="name-holder-setup-2">
<a href="#section-6.4.1" class="section-number selfRef">6.4.1. </a><a href="#name-holder-setup-2" class="section-name selfRef">Holder Setup</a>
          </h4>
<p id="section-6.4.1-1">Prior to the issuer creating a new JWP, the issuer MUST have a
presentation public key provided by the holder.<a href="#section-6.4.1-1" class="pilcrow">¶</a></p>
<p id="section-6.4.1-2">The holder's presentation key MUST be included in the issuer's protected
header using the Presentation Key header parameter.<a href="#section-6.4.1-2" class="pilcrow">¶</a></p>
<p id="section-6.4.1-3">The issuer MUST determine an appropriate holder presentation algorithm
corresponding to the presentation key.  If the holder and verifier cannot
be assumed to know this algorithm is the appropriate choice for a given
presentation key, this value MUST be conveyed in the Holder Protected
algorithm header parameter.<a href="#section-6.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer-setup-1">
<section id="section-6.4.2">
          <h4 id="name-issuer-setup-2">
<a href="#section-6.4.2" class="section-number selfRef">6.4.2. </a><a href="#name-issuer-setup-2" class="section-name selfRef">Issuer Setup</a>
          </h4>
<p id="section-6.4.2-1">To use the MAC algorithm, the issuer must have a stable public key pair
to perform signing.  To start the issuance process, a single 32-byte
random Shared Secret must first be generated.  This value will be shared
privately with the holder as part of the issuer's JWP proof value.<a href="#section-6.4.2-1" class="pilcrow">¶</a></p>
<p id="section-6.4.2-2">The Shared Secret is used by both the issuer and holder as the MAC
method's key to generate a new set of unique ephemeral keys.  These keys
are then used as the input to generate a MAC that protects each payload.<a href="#section-6.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="combined-mac-representation">
<section id="section-6.4.3">
          <h4 id="name-combined-mac-representation">
<a href="#section-6.4.3" class="section-number selfRef">6.4.3. </a><a href="#name-combined-mac-representation" class="section-name selfRef">Combined MAC Representation</a>
          </h4>
<p id="section-6.4.3-1">The combined MAC representation is a single octet string representing
the MAC values of the issuer protected header, along with each payload
provided by the issuer.  This representation is signed by the issuer, but
not shared - parties will recreate this octet string and verify the
signature to verify the integrity of supplied issuer protected header
and the integrity of any disclosed payloads.<a href="#section-6.4.3-1" class="pilcrow">¶</a></p>
<p id="section-6.4.3-2">The steps below describe a sequential concatenation of binary values to
generate the Combined MAC Representation.  The instructions for
generating this octet string will also generate well-formed CBOR,
although this data is not meant to be shared outside the implementing
algorithm.  Instead, it focuses on simplicity of generation by the
issuer, holder, and verifier implementations.  Although CBOR has multiple
representations of the same underlying information, this same octet
string MUST be generated by an implementation.<a href="#section-6.4.3-2" class="pilcrow">¶</a></p>
<p id="section-6.4.3-3">When a length or count is added by steps in this section, it is added as
its 8-byte, network-ordered representation.  For example, the length of
a 1,234-byte payload would have a length representation of
<code>0x00 00 00 00 00 00 04 D2</code>.<a href="#section-6.4.3-3" class="pilcrow">¶</a></p>
<p id="section-6.4.3-4">The holder will a unique key per payload value using a MAC, with the
Shared Secret as the key and a generated binary value.  This binary
value is constructed by appending data into a single octet string:<a href="#section-6.4.3-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-6.4.3-5">
<li id="section-6.4.3-5.1">
              <code>0x82 67 70 61 79 6C 6F 61 64 1B</code><a href="#section-6.4.3-5.1" class="pilcrow">¶</a>
</li>
            <li id="section-6.4.3-5.2">The zero indexed count of the payload slot<a href="#section-6.4.3-5.2" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-6.4.3-6">The holder will also compute a corresponding MAC of each payload.  This
MAC uses the unique key above and the payload octet string as the value.<a href="#section-6.4.3-6" class="pilcrow">¶</a></p>
<p id="section-6.4.3-7">When verifying a presentation, the shared secret will be unavailable so
the unique key cannot be calculated.  The payload octet string may also
be omitted in the presentation.  The following instructions describe how
to get the corresponding MAC of each payload:<a href="#section-6.4.3-7" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.4.3-8.1">If the payload is disclosed, the corresponding proof component (as
described in <a href="#mac-presentation-proof">MAC Presentation Proof</a>)
will contain the generated unique key.  The payload MAC will be
calculated using this key and the payload octets as the value.<a href="#section-6.4.3-8.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-6.4.3-8.2">If the payload is not disclosed, the corresponding proof component
will be the payload MAC.<a href="#section-6.4.3-8.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.4.3-9">The binary representation is created by appending data into a single
octet string in the following order:<a href="#section-6.4.3-9" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-6.4.3-10">
<li id="section-6.4.3-10.1">
              <code>0x82 5B</code><a href="#section-6.4.3-10.1" class="pilcrow">¶</a>
</li>
            <li id="section-6.4.3-10.2">The length and octets of the issuer protected header<a href="#section-6.4.3-10.2" class="pilcrow">¶</a>
</li>
            <li id="section-6.4.3-10.3">
              <code>0x9B</code><a href="#section-6.4.3-10.3" class="pilcrow">¶</a>
</li>
            <li id="section-6.4.3-10.4">The number of payload slots in the issued JWP<a href="#section-6.4.3-10.4" class="pilcrow">¶</a>
</li>
            <li id="section-6.4.3-10.5">
              <p id="section-6.4.3-10.5.1">For each payload representation:<a href="#section-6.4.3-10.5.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-6.4.3-10.5.2">
<li id="section-6.4.3-10.5.2.1">
                  <code>0x5B</code><a href="#section-6.4.3-10.5.2.1" class="pilcrow">¶</a>
</li>
                <li id="section-6.4.3-10.5.2.2">The length and value of the per payload MAC<a href="#section-6.4.3-10.5.2.2" class="pilcrow">¶</a>
</li>
              </ol>
</li>
          </ol>
</section>
</div>
<div id="issuer-protected-header-1">
<section id="section-6.4.4">
          <h4 id="name-issuer-protected-header-2">
<a href="#section-6.4.4" class="section-number selfRef">6.4.4. </a><a href="#name-issuer-protected-header-2" class="section-name selfRef">Issuer Protected Header</a>
          </h4>
<p id="section-6.4.4-1">The Holder's Presentation Key MUST be included via the Presentation Key
header parameter.<a href="#section-6.4.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4.4-2">The Holder's Presentation Algorithm MUST be included via the Holder
Presentation Algorithm header parameter unless there is another way for
the holder and verifier to unambiguously determine the appropriate
algorithm to use.<a href="#section-6.4.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer-proof">
<section id="section-6.4.5">
          <h4 id="name-issuer-proof">
<a href="#section-6.4.5" class="section-number selfRef">6.4.5. </a><a href="#name-issuer-proof" class="section-name selfRef">Issuer Proof</a>
          </h4>
<p id="section-6.4.5-1">The issuer proof consists of two octet strings.<a href="#section-6.4.5-1" class="pilcrow">¶</a></p>
<p id="section-6.4.5-2">The first octet string is the issuer signature over the combined MAC
representation.  The issuer signs the combined MAC representation using
its stable public key, and the internal signing algorithm for the given
fully-specified MAC algorithm variant.<a href="#section-6.4.5-2" class="pilcrow">¶</a></p>
<p id="section-6.4.5-3">The second octet string is the Shared Secret used to generate the
per-payload keys for the combined representation.<a href="#section-6.4.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="presentation-protected-header">
<section id="section-6.4.6">
          <h4 id="name-presentation-protected-heade">
<a href="#section-6.4.6" class="section-number selfRef">6.4.6. </a><a href="#name-presentation-protected-heade" class="section-name selfRef">Presentation Protected Header</a>
          </h4>
<p id="section-6.4.6-1">See the <a href="#presentation-protected-header">Presentation Protected Header</a>
section given for Single Use algorithms.<a href="#section-6.4.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mac-presentation-proof">
<section id="section-6.4.7">
          <h4 id="name-presentation-proof">
<a href="#section-6.4.7" class="section-number selfRef">6.4.7. </a><a href="#name-presentation-proof" class="section-name selfRef">Presentation Proof</a>
          </h4>
<p id="section-6.4.7-1">The presentation proof is made of multiple components.<a href="#section-6.4.7-1" class="pilcrow">¶</a></p>
<p id="section-6.4.7-2">The first proof component is the issuer signature over the Combined MAC
Representation, which is provided as the first proof component from the
issued form.<a href="#section-6.4.7-2" class="pilcrow">¶</a></p>
<p id="section-6.4.7-3">There will now be one proof component per payload slot in the issued
JWP.  These are used by the verifier to reconstruct the combined MAC
representation without access to the Shared Secret.  The proof
components are calculated per the instructions used to generate the
<a href="#combined-mac-representation">Combined MAC Representation</a><a href="#section-6.4.7-3" class="pilcrow">¶</a></p>
<p id="section-6.4.7-4">If a payload is disclosed, the corresponding proof component will be the
unique key.<a href="#section-6.4.7-4" class="pilcrow">¶</a></p>
<p id="section-6.4.7-5">If a payload is not disclosed, the corresponding proof component will be
the payload's MAC (using the unique key.)<a href="#section-6.4.7-5" class="pilcrow">¶</a></p>
<p id="section-6.4.7-6">The holder protected header, issuer protected header, payload slots
(distinguishing which are being disclosed) and above proof components
are inputs to determine the <a href="#presentation-internal-representation">presentation internal
representation</a>.<a href="#section-6.4.7-6" class="pilcrow">¶</a></p>
<p id="section-6.4.7-7">The holder's signature over the presentation internal representation
(using the holder's private key and the holder presentation algorithm)
is then included as one additional proof component in the final
presentation.<a href="#section-6.4.7-7" class="pilcrow">¶</a></p>
<p id="section-6.4.7-8">The presented form should have two more proof components than payload
slots in the issued JWP.<a href="#section-6.4.7-8" class="pilcrow">¶</a></p>
<p id="section-6.4.7-9">Note that the second component of the issued JWP is a shared secret for
use by the holder to generate the unique keys used in the Combined MAC
Representation.  This MUST NOT be included in the presentation.<a href="#section-6.4.7-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verification-of-the-presentation-proof">
<section id="section-6.4.8">
          <h4 id="name-verification-of-the-present">
<a href="#section-6.4.8" class="section-number selfRef">6.4.8. </a><a href="#name-verification-of-the-present" class="section-name selfRef">Verification of the Presentation Proof</a>
          </h4>
<p id="section-6.4.8-1">Verification is performed using the following steps.<a href="#section-6.4.8-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-6.4.8-2">
<li id="section-6.4.8-2.1">Check the number of proof components is appropriate for the number of
disclosed payloads.  There MUST be two more proof components than
disclosed payloads.<a href="#section-6.4.8-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-6.4.8-2.2">Using the fully-specified MAC algorithm in use, use the issuer
protected header, disclosed payloads, and the proof components
corresponding to the payloads to regenerate the Combined MAC
Representation.<a href="#section-6.4.8-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-6.4.8-2.3">Verify the first proof component is a valid signature over the issuer
protected header octets, using the issuer's stable key.<a href="#section-6.4.8-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-6.4.8-2.4">Extract the presentation key and holder presentation algorithm (if
present) from the issuer protected header.<a href="#section-6.4.8-2.4" class="pilcrow">¶</a>
</li>
            <li id="section-6.4.8-2.5">Omitting the final payload component, calculate the <a href="#presentation-internal-representation">presentation
internal representation</a>.<a href="#section-6.4.8-2.5" class="pilcrow">¶</a>
</li>
            <li id="section-6.4.8-2.6">Verify the final proof component is a valid signature over the
presentation internal binary form, using the holder's presentation
key and the extracted (or otherwise determined) holder presentation
algorithm.<a href="#section-6.4.8-2.6" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="MAC-registration">
<section id="section-6.4.9">
          <h4 id="name-jpa-registration-2">
<a href="#section-6.4.9" class="section-number selfRef">6.4.9. </a><a href="#name-jpa-registration-2" class="section-name selfRef">JPA Registration</a>
          </h4>
<p id="section-6.4.9-1">Proposed JWP <code>alg</code> value is of the format "MAC-" appended with a unique
identifier for the set of MAC and signing algorithms used.  Below are
the initial registrations:<a href="#section-6.4.9-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-6.4.9-2.1">
              <code>MAC-H256</code> uses <code>HMAC SHA-256</code> as the MAC and
<code>ECDSA using P-256 and SHA-256</code> for the signatures<a href="#section-6.4.9-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-6.4.9-2.2">
              <code>MAC-H384</code> uses <code>HMAC SHA-384</code> as the MAC and
<code>ECDSA using P-384 and SHA-384</code> for the signatures<a href="#section-6.4.9-2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-6.4.9-2.3">
              <code>MAC-H512</code> uses <code>HMAC SHA-512</code> as the MAC and
<code>ECDSA using P-521 and SHA-512</code> for the signatures<a href="#section-6.4.9-2.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-6.4.9-2.4">
              <code>MAC-K25519</code> uses <code>KMAC SHAKE128</code> as the MAC and
<code>EdDSA using Curve25519</code> for the signatures<a href="#section-6.4.9-2.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-6.4.9-2.5">
              <code>MAC-K448</code> uses <code>KMAC SHAKE256</code> as the MAC and <code>EdDSA using Curve448</code>
for the signatures<a href="#section-6.4.9-2.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-6.4.9-2.6">
              <code>MAC-H256K</code> uses <code>HMAC SHA-256</code> as the MAC and
<code>ECDSA using secp256k1 and SHA-256</code> for the signatures<a href="#section-6.4.9-2.6" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<blockquote id="section-7-1">
        <p id="section-7-1.1">Editor's Note: This will follow once the algorithms defined here have
become more stable.<a href="#section-7-1.1" class="pilcrow">¶</a></p>
</blockquote>
<ul class="compact">
<li class="compact" id="section-7-2.1">Data minimization of the proof value<a href="#section-7-2.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-7-2.2">Unlinkability of the protected header contents<a href="#section-7-2.2" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">The following registration procedure is used for all the registries
established by this specification.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Values are registered on a Specification Required <span>[<a href="#RFC5226" class="cite xref">RFC5226</a>]</span> basis after
a three-week review period on the <a href="mailto:jose-reg-review@ietf.org">jose-reg-review@ietf.org</a> mailing
list, on the advice of one or more Designated Experts.  However, to
allow for the allocation of values prior to publication, the Designated
Experts may approve registration once they are satisfied that such a
specification will be published.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">Registration requests sent to the mailing list for review should use an
appropriate subject (e.g., "Request to register JWP algorithm:
example").<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">Within the review period, the Designated Experts will either approve or
deny the registration request, communicating this decision to the review
list and IANA.  Denials should include an explanation and, if
applicable, suggestions as to how to make the request successful.
Registration requests that are undetermined for a period longer than 21
days can be brought to the IESG's attention (using the <a href="mailto:iesg@ietf.org">iesg@ietf.org</a>
mailing list) for resolution.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">Criteria that should be applied by the Designated Experts include
determining whether the proposed registration duplicates existing
functionality, whether it is likely to be of general applicability or
useful only for a single application, and whether the registration
description is clear.<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">IANA must only accept registry updates from the Designated Experts and
should direct all requests for registration to the review mailing list.<a href="#section-8-6" class="pilcrow">¶</a></p>
<p id="section-8-7">It is suggested that multiple Designated Experts be appointed who are
able to represent the perspectives of different applications using this
specification, in order to enable broadly informed review of
registration decisions.  In cases where a registration decision could be
perceived as creating a conflict of interest for a particular Expert,
that Expert should defer to the judgment of the other Experts.<a href="#section-8-7" class="pilcrow">¶</a></p>
<div id="AlgsReg">
<section id="section-8.1">
        <h3 id="name-json-web-proof-algorithms-r">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-json-web-proof-algorithms-r" class="section-name selfRef">JSON Web Proof Algorithms Registry</a>
        </h3>
<p id="section-8.1-1">This specification establishes the IANA "JSON Web Proof Algorithms"
registry for values of the JWP <code>alg</code> (algorithm) parameter in JWP Header
Parameters.  The registry records the algorithm name, the algorithm
description, the algorithm usage locations, the implementation
requirements, the change controller, and a reference to the
specification that defines it.  The same algorithm name can be
registered multiple times, provided that the sets of usage locations are
disjoint.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">It is suggested that the length of the key be included in the algorithm
name when multiple variations of algorithms are being registered that
use keys of different lengths and the key lengths for each need to be
fixed (for instance, because they will be created by key derivation
functions).  This allows readers of the JSON text to more easily make
security decisions.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">The Designated Experts should perform reasonable due diligence that
algorithms being registered either are currently considered
cryptographically credible or are being registered as Deprecated or
Prohibited.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1-4">The implementation requirements of an algorithm may be changed over time
as the cryptographic landscape evolves, for instance, to change the
status of an algorithm to Deprecated or to change the status of an
algorithm from Optional to Recommended+ or Required.  Changes of
implementation requirements are only permitted on a Specification
Required basis after review by the Designated Experts, with the new
specification defining the revised implementation requirements level.<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<div id="AlgsTemplate">
<section id="section-8.1.1">
          <h4 id="name-registration-template">
<a href="#section-8.1.1" class="section-number selfRef">8.1.1. </a><a href="#name-registration-template" class="section-name selfRef">Registration Template</a>
          </h4>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-8.1.1-1">
            <dt id="section-8.1.1-1.1">Algorithm Name:</dt>
            <dd style="margin-left: 1.5em" id="section-8.1.1-1.2">Brief descriptive name of the algorithm
(e.g., <code>Single-Use JWP using ES256</code>.)
Descriptive names may not match other registered names unless the
Designated Experts state that there is a compelling reason to
allow an exception.<a href="#section-8.1.1-1.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.1.1-1.3">Algorithm JSON Label:</dt>
            <dd style="margin-left: 1.5em" id="section-8.1.1-1.4">The string label requested (e.g., <code>SU-ES256</code>).  This label is a
case-sensitive ASCII string.  JSON Labels may not match other
registered labels in a case-insensitive manner unless the
Designated Experts state that there is a compelling reason to allow
an exception.<a href="#section-8.1.1-1.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.1.1-1.5">Algorithm CBOR Label:</dt>
            <dd style="margin-left: 1.5em" id="section-8.1.1-1.6">The integer label requested (e.g., <code>1</code>).  CBOR Labels may not match
other registered labels unless the Designated Experts state that there
is a compelling reason to allow an exception.<a href="#section-8.1.1-1.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.1.1-1.7">Algorithm Description:</dt>
            <dd style="margin-left: 1.5em" id="section-8.1.1-1.8">Optional additional information clarifying the algorithm.  This may be
used for example to document additional chosen parameters.<a href="#section-8.1.1-1.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.1.1-1.9">Algorithm Usage Location(s):</dt>
            <dd style="margin-left: 1.5em" id="section-8.1.1-1.10">The algorithm usage locations, which should be one or more of the
values <code>Issued</code> or <code>Presented</code>.  Other values may be used with the
approval of a Designated Expert.<a href="#section-8.1.1-1.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.1.1-1.11">JWP Implementation Requirements:</dt>
            <dd style="margin-left: 1.5em" id="section-8.1.1-1.12">The algorithm implementation requirements for JWP, which must be one
the words <code>Required</code>, <code>Recommended</code>, <code>Optional</code>, <code>Deprecated</code>, or
<code>Prohibited</code>.  Optionally, the word can be followed by a <code>+</code> or <code>-</code>.
The use of <code>+</code> indicates that the requirement strength is likely to be
increased in a future version of the specification.  The use of <code>-</code>
indicates that the requirement strength is likely to be decreased in a
future version of the specification.  Any identifiers registered for
algorithms that are otherwise unsuitable for direct use as JWP
algorithms must be registered as <code>Prohibited</code>.<a href="#section-8.1.1-1.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.1.1-1.13">Change Controller:</dt>
            <dd style="margin-left: 1.5em" id="section-8.1.1-1.14">For Standards Track RFCs, list the "IETF".  For others, give the name
of the responsible party.  Other details (e.g., postal address, email
address, home page URI) may also be included.<a href="#section-8.1.1-1.14" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.1.1-1.15">Specification Document(s):</dt>
            <dd style="margin-left: 1.5em" id="section-8.1.1-1.16">Reference to the document or documents that specify the parameter,
preferably including URIs that can be used to retrieve copies of the
documents.  An indication of the relevant sections may also be
included but is not required.<a href="#section-8.1.1-1.16" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-8.1.1-1.17">Algorithm Analysis Documents(s):</dt>
            <dd style="margin-left: 1.5em" id="section-8.1.1-1.18">References to a publication or publications in well-known
cryptographic conferences, by national standards bodies, or by other
authoritative sources analyzing the cryptographic soundness of the
algorithm to be registered.  The Designated Experts may require
convincing evidence of the cryptographic soundness of a new algorithm
to be provided with the registration request unless the algorithm is
being registered as Deprecated or Prohibited.  Having gone through
working group and IETF review, the initial registrations made by this
document are exempt from the need to provide this information.<a href="#section-8.1.1-1.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="AlgsContents">
<section id="section-8.1.2">
          <h4 id="name-initial-registry-contents">
<a href="#section-8.1.2" class="section-number selfRef">8.1.2. </a><a href="#name-initial-registry-contents" class="section-name selfRef">Initial Registry Contents</a>
          </h4>
<div id="single-use-jwp-using-es256-algorithm">
<section id="section-8.1.2.1">
            <h5 id="name-single-use-jwp-using-es256-">
<a href="#section-8.1.2.1" class="section-number selfRef">8.1.2.1. </a><a href="#name-single-use-jwp-using-es256-" class="section-name selfRef">Single-Use JWP using ES256 Algorithm</a>
            </h5>
<ul class="compact">
<li class="compact" id="section-8.1.2.1-1.1">Algorithm Name: Single-Use JWP using ES256<a href="#section-8.1.2.1-1.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.1-1.2">Algorithm JSON Label: <code>SU-ES256</code><a href="#section-8.1.2.1-1.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.1-1.3">Algorithm CBOR Label: 1<a href="#section-8.1.2.1-1.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.1-1.4">Algorithm Usage Location(s): Issued, Presented<a href="#section-8.1.2.1-1.4" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.1-1.5">JWP Implementation Requirements: Recommended<a href="#section-8.1.2.1-1.5" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.1-1.6">Change Controller: IETF<a href="#section-8.1.2.1-1.6" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.1-1.7">Specification Document(s): <a href="#SU-registration" class="auto internal xref">Section 6.1.11</a> of this specification<a href="#section-8.1.2.1-1.7" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.1-1.8">Algorithm Analysis Documents(s): n/a<a href="#section-8.1.2.1-1.8" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="single-use-jwp-using-es384-algorithm">
<section id="section-8.1.2.2">
            <h5 id="name-single-use-jwp-using-es384-">
<a href="#section-8.1.2.2" class="section-number selfRef">8.1.2.2. </a><a href="#name-single-use-jwp-using-es384-" class="section-name selfRef">Single-Use JWP using ES384 Algorithm</a>
            </h5>
<ul class="compact">
<li class="compact" id="section-8.1.2.2-1.1">Algorithm Name: Single-Use JWP using ES384<a href="#section-8.1.2.2-1.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.2-1.2">Algorithm JSON Label: <code>SU-ES384</code><a href="#section-8.1.2.2-1.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.2-1.3">Algorithm CBOR Label: 2<a href="#section-8.1.2.2-1.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.2-1.4">Algorithm Usage Location(s): Issued, Presented<a href="#section-8.1.2.2-1.4" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.2-1.5">JWP Implementation Requirements: Optional<a href="#section-8.1.2.2-1.5" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.2-1.6">Change Controller: IETF<a href="#section-8.1.2.2-1.6" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.2-1.7">Specification Document(s): <a href="#SU-registration" class="auto internal xref">Section 6.1.11</a> of this specification<a href="#section-8.1.2.2-1.7" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.2-1.8">Algorithm Analysis Documents(s): n/a<a href="#section-8.1.2.2-1.8" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="single-use-jwp-using-es512-algorithm">
<section id="section-8.1.2.3">
            <h5 id="name-single-use-jwp-using-es512-">
<a href="#section-8.1.2.3" class="section-number selfRef">8.1.2.3. </a><a href="#name-single-use-jwp-using-es512-" class="section-name selfRef">Single-Use JWP using ES512 Algorithm</a>
            </h5>
<ul class="compact">
<li class="compact" id="section-8.1.2.3-1.1">Algorithm Name: Single-Use JWP using ES512<a href="#section-8.1.2.3-1.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.3-1.2">Algorithm JSON Label: <code>SU-ES512</code><a href="#section-8.1.2.3-1.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.3-1.3">Algorithm CBOR Label: 3<a href="#section-8.1.2.3-1.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.3-1.4">Algorithm Usage Location(s): Issued, Presented<a href="#section-8.1.2.3-1.4" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.3-1.5">JWP Implementation Requirements: Optional<a href="#section-8.1.2.3-1.5" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.3-1.6">Change Controller: IETF<a href="#section-8.1.2.3-1.6" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.3-1.7">Specification Document(s): <a href="#SU-registration" class="auto internal xref">Section 6.1.11</a> of this specification<a href="#section-8.1.2.3-1.7" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.3-1.8">Algorithm Analysis Documents(s): n/a<a href="#section-8.1.2.3-1.8" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="bbs-using-sha-256-algorithm">
<section id="section-8.1.2.4">
            <h5 id="name-bbs-using-sha-256-algorithm">
<a href="#section-8.1.2.4" class="section-number selfRef">8.1.2.4. </a><a href="#name-bbs-using-sha-256-algorithm" class="section-name selfRef">BBS using SHA-256 Algorithm</a>
            </h5>
<ul class="compact">
<li class="compact" id="section-8.1.2.4-1.1">Algorithm Name: BBS using SHA-256<a href="#section-8.1.2.4-1.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.4-1.2">Algorithm JSON Label: <code>BBS</code><a href="#section-8.1.2.4-1.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.4-1.3">Algorithm CBOR Label: 4<a href="#section-8.1.2.4-1.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.4-1.4">Algorithm Description: Corresponds to a ciphersuite identifier of
<code>BBS_BLS12381G1_XMD:SHA-256_SSWU_RO_H2G_HM2S_</code><a href="#section-8.1.2.4-1.4" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.4-1.5">Algorithm Usage Location(s): Issued, Presented<a href="#section-8.1.2.4-1.5" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.4-1.6">JWP Implementation Requirements: Required<a href="#section-8.1.2.4-1.6" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.4-1.7">Change Controller: IETF<a href="#section-8.1.2.4-1.7" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.4-1.8">Specification Document(s): <a href="#BBS-registration" class="auto internal xref">Section 6.3.1</a> of this specification<a href="#section-8.1.2.4-1.8" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.4-1.9">Algorithm Analysis Documents(s): n/a<a href="#section-8.1.2.4-1.9" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="mac-h256-algorithm">
<section id="section-8.1.2.5">
            <h5 id="name-mac-h256-algorithm">
<a href="#section-8.1.2.5" class="section-number selfRef">8.1.2.5. </a><a href="#name-mac-h256-algorithm" class="section-name selfRef">MAC-H256 Algorithm</a>
            </h5>
<ul class="compact">
<li class="compact" id="section-8.1.2.5-1.1">Algorithm Name: MAC-H256<a href="#section-8.1.2.5-1.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.5-1.2">Algorithm JSON Label: <code>MAC-H256</code><a href="#section-8.1.2.5-1.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.5-1.3">Algorithm CBOR Label: 5<a href="#section-8.1.2.5-1.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.5-1.4">Algorithm Description: <code>MAC-H256</code> uses <code>HMAC SHA-256</code> as the MAC, and
<code>ECDSA using P-256 and SHA-256</code> for the signatures<a href="#section-8.1.2.5-1.4" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.5-1.5">Algorithm Usage Location(s): Issued, Presented<a href="#section-8.1.2.5-1.5" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.5-1.6">JWP Implementation Requirements: Optional<a href="#section-8.1.2.5-1.6" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.5-1.7">Change Controller: IETF<a href="#section-8.1.2.5-1.7" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.5-1.8">Specification Document(s): <a href="#MAC-registration" class="auto internal xref">Section 6.4.9</a> of this specification<a href="#section-8.1.2.5-1.8" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.5-1.9">Algorithm Analysis Documents(s): n/a<a href="#section-8.1.2.5-1.9" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="mac-h384-algorithm">
<section id="section-8.1.2.6">
            <h5 id="name-mac-h384-algorithm">
<a href="#section-8.1.2.6" class="section-number selfRef">8.1.2.6. </a><a href="#name-mac-h384-algorithm" class="section-name selfRef">MAC-H384 Algorithm</a>
            </h5>
<ul class="compact">
<li class="compact" id="section-8.1.2.6-1.1">Algorithm Name: MAC-H384<a href="#section-8.1.2.6-1.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.6-1.2">Algorithm JSON Label: <code>MAC-H384</code><a href="#section-8.1.2.6-1.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.6-1.3">Algorithm CBOR Label: 6<a href="#section-8.1.2.6-1.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.6-1.4">Algorithm Description: <code>MAC-H384</code> uses <code>HMAC SHA-384</code> as the MAC, and
<code>ECDSA using P-384 and SHA-384</code> for the signatures<a href="#section-8.1.2.6-1.4" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.6-1.5">Algorithm Usage Location(s): Issued, Presented<a href="#section-8.1.2.6-1.5" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.6-1.6">JWP Implementation Requirements: Optional<a href="#section-8.1.2.6-1.6" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.6-1.7">Change Controller: IETF<a href="#section-8.1.2.6-1.7" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.6-1.8">Specification Document(s): <a href="#MAC-registration" class="auto internal xref">Section 6.4.9</a> of this specification<a href="#section-8.1.2.6-1.8" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.6-1.9">Algorithm Analysis Documents(s): n/a<a href="#section-8.1.2.6-1.9" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="mac-h512-algorithm">
<section id="section-8.1.2.7">
            <h5 id="name-mac-h512-algorithm">
<a href="#section-8.1.2.7" class="section-number selfRef">8.1.2.7. </a><a href="#name-mac-h512-algorithm" class="section-name selfRef">MAC-H512 Algorithm</a>
            </h5>
<ul class="compact">
<li class="compact" id="section-8.1.2.7-1.1">Algorithm Name: MAC-H512<a href="#section-8.1.2.7-1.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.7-1.2">Algorithm JSON Label: <code>MAC-H512</code><a href="#section-8.1.2.7-1.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.7-1.3">Algorithm CBOR Label: 7<a href="#section-8.1.2.7-1.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.7-1.4">Algorithm Description: <code>MAC-H512</code> uses <code>HMAC SHA-512</code> as the MAC, and
<code>ECDSA using P-521 and SHA-512</code> for the signatures<a href="#section-8.1.2.7-1.4" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.7-1.5">Algorithm Usage Location(s): Issued, Presented<a href="#section-8.1.2.7-1.5" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.7-1.6">JWP Implementation Requirements: Optional<a href="#section-8.1.2.7-1.6" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.7-1.7">Change Controller: IETF<a href="#section-8.1.2.7-1.7" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.7-1.8">Specification Document(s): <a href="#MAC-registration" class="auto internal xref">Section 6.4.9</a> of this specification<a href="#section-8.1.2.7-1.8" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.7-1.9">Algorithm Analysis Documents(s): n/a<a href="#section-8.1.2.7-1.9" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="mac-k25519-algorithm">
<section id="section-8.1.2.8">
            <h5 id="name-mac-k25519-algorithm">
<a href="#section-8.1.2.8" class="section-number selfRef">8.1.2.8. </a><a href="#name-mac-k25519-algorithm" class="section-name selfRef">MAC-K25519 Algorithm</a>
            </h5>
<ul class="compact">
<li class="compact" id="section-8.1.2.8-1.1">Algorithm Name: MAC-K25519<a href="#section-8.1.2.8-1.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.8-1.2">Algorithm JSON Label: <code>MAC-K25519</code><a href="#section-8.1.2.8-1.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.8-1.3">Algorithm CBOR Label: 8<a href="#section-8.1.2.8-1.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.8-1.4">Algorithm Description: <code>MAC-K25519</code> uses <code>KMAC SHAKE128</code> as the MAC,
and <code>EdDSA using Curve25519</code> for the signatures<a href="#section-8.1.2.8-1.4" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.8-1.5">Algorithm Usage Location(s): Issued, Presented<a href="#section-8.1.2.8-1.5" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.8-1.6">JWP Implementation Requirements: Optional<a href="#section-8.1.2.8-1.6" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.8-1.7">Change Controller: IETF<a href="#section-8.1.2.8-1.7" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.8-1.8">Specification Document(s): <a href="#MAC-registration" class="auto internal xref">Section 6.4.9</a> of this specification<a href="#section-8.1.2.8-1.8" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.8-1.9">Algorithm Analysis Documents(s): n/a<a href="#section-8.1.2.8-1.9" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="mac-k448-algorithm">
<section id="section-8.1.2.9">
            <h5 id="name-mac-k448-algorithm">
<a href="#section-8.1.2.9" class="section-number selfRef">8.1.2.9. </a><a href="#name-mac-k448-algorithm" class="section-name selfRef">MAC-K448 Algorithm</a>
            </h5>
<ul class="compact">
<li class="compact" id="section-8.1.2.9-1.1">Algorithm Name: MAC-K448<a href="#section-8.1.2.9-1.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.9-1.2">Algorithm JSON Label: <code>MAC-K448</code><a href="#section-8.1.2.9-1.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.9-1.3">Algorithm CBOR Label: 9<a href="#section-8.1.2.9-1.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.9-1.4">Algorithm Description: <code>MAC-K448</code> uses <code>KMAC SHAKE256</code> as the MAC, and
<code>EdDSA using Curve448</code> for the signatures<a href="#section-8.1.2.9-1.4" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.9-1.5">Algorithm Usage Location(s): Issued, Presented<a href="#section-8.1.2.9-1.5" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.9-1.6">JWP Implementation Requirements: Optional<a href="#section-8.1.2.9-1.6" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.9-1.7">Change Controller: IETF<a href="#section-8.1.2.9-1.7" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.9-1.8">Specification Document(s): <a href="#MAC-registration" class="auto internal xref">Section 6.4.9</a> of this specification<a href="#section-8.1.2.9-1.8" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.9-1.9">Algorithm Analysis Documents(s): n/a<a href="#section-8.1.2.9-1.9" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="mac-h256k-algorithm">
<section id="section-8.1.2.10">
            <h5 id="name-mac-h256k-algorithm">
<a href="#section-8.1.2.10" class="section-number selfRef">8.1.2.10. </a><a href="#name-mac-h256k-algorithm" class="section-name selfRef">MAC-H256K Algorithm</a>
            </h5>
<ul class="compact">
<li class="compact" id="section-8.1.2.10-1.1">Algorithm Name: MAC-H256K<a href="#section-8.1.2.10-1.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.10-1.2">Algorithm JSON Label: <code>MAC-H256K</code><a href="#section-8.1.2.10-1.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.10-1.3">Algorithm CBOR Label: 10<a href="#section-8.1.2.10-1.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.10-1.4">Algorithm Description: <code>MAC-H256K</code> uses <code>HMAC SHA-256</code> as the MAC, and
<code>ECDSA using secp256k1 and SHA-256</code> for the signatures<a href="#section-8.1.2.10-1.4" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.10-1.5">Algorithm Usage Location(s): Issued, Presented<a href="#section-8.1.2.10-1.5" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.10-1.6">JWP Implementation Requirements: Optional<a href="#section-8.1.2.10-1.6" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.10-1.7">Change Controller: IETF<a href="#section-8.1.2.10-1.7" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.10-1.8">Specification Document(s): <a href="#MAC-registration" class="auto internal xref">Section 6.4.9</a> of this specification<a href="#section-8.1.2.10-1.8" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.1.2.10-1.9">Algorithm Analysis Documents(s): n/a<a href="#section-8.1.2.10-1.9" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-jose-json-web-proof">[I-D.ietf-jose-json-web-proof]</dt>
        <dd>
<span class="refAuthor">Waite, D.</span>, <span class="refAuthor">Jones, M. B.</span>, and <span class="refAuthor">J. Miller</span>, <span class="refTitle">"JSON Web Proof"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-jose-json-web-proof-latest</span>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-jose-json-web-proof">https://datatracker.ietf.org/doc/html/draft-ietf-jose-json-web-proof</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-bbs-signatures">[I-D.irtf-cfrg-bbs-signatures]</dt>
        <dd>
<span class="refAuthor">Looker, T.</span>, <span class="refAuthor">Kalos, V.</span>, <span class="refAuthor">Whitehead, A.</span>, and <span class="refAuthor">M. Lodder</span>, <span class="refTitle">"The BBS Signature Scheme"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-bbs-signatures-08</span>, <time datetime="2025-03-03" class="refDate">3 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bbs-signatures-08">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bbs-signatures-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7515">[RFC7515]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-cbor-edn-literals">[I-D.ietf-cbor-edn-literals]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"CBOR Extended Diagnostic Notation (EDN)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cbor-edn-literals-17</span>, <time datetime="2025-05-12" class="refDate">12 May 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-edn-literals-17">https://datatracker.ietf.org/doc/html/draft-ietf-cbor-edn-literals-17</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-bls-key-representations">[I-D.ietf-cose-bls-key-representations]</dt>
        <dd>
<span class="refAuthor">Looker, T.</span> and <span class="refAuthor">M. B. Jones</span>, <span class="refTitle">"Barreto-Lynn-Scott Elliptic Curve Key Representations for JOSE and COSE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-bls-key-representations-06</span>, <time datetime="2025-01-18" class="refDate">18 January 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-bls-key-representations-06">https://datatracker.ietf.org/doc/html/draft-ietf-cose-bls-key-representations-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.maldant-spice-oidc-cwt">[I-D.maldant-spice-oidc-cwt]</dt>
        <dd>
<span class="refAuthor">Maldant, B.</span>, <span class="refTitle">"OpenID Connect standard claims registration for CBOR Web Tokens"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-maldant-spice-oidc-cwt-02</span>, <time datetime="2025-03-17" class="refDate">17 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-maldant-spice-oidc-cwt-02">https://datatracker.ietf.org/doc/html/draft-maldant-spice-oidc-cwt-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2104">[RFC2104]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time datetime="1997-02" class="refDate">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2104">https://www.rfc-editor.org/info/rfc2104</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5226">[RFC5226]</dt>
        <dd>
<span class="refAuthor">Narten, T.</span> and <span class="refAuthor">H. Alvestrand</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">RFC 5226</span>, <span class="seriesInfo">DOI 10.17487/RFC5226</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5226">https://www.rfc-editor.org/info/rfc5226</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7518">[RFC7518]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Algorithms (JWA)"</span>, <span class="seriesInfo">RFC 7518</span>, <span class="seriesInfo">DOI 10.17487/RFC7518</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7518">https://www.rfc-editor.org/info/rfc7518</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="VC-DATA-MODEL-2.0">[VC-DATA-MODEL-2.0]</dt>
      <dd>
<span class="refAuthor">Sporny, M.</span>, <span class="refAuthor">Jr, T. T.</span>, <span class="refAuthor">Herman, I.</span>, <span class="refAuthor">Cohen, G.</span>, and <span class="refAuthor">M. B. Jones</span>, <span class="refTitle">"Verifiable Credentials Data Model v2.0"</span>, <time datetime="2025-05-15" class="refDate">15 May 2025</time>, <span>&lt;<a href="https://www.w3.org/TR/vc-data-model-2.0">https://www.w3.org/TR/vc-data-model-2.0</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="example-jwps">
<section id="appendix-A">
      <h2 id="name-example-jwps">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-example-jwps" class="section-name selfRef">Example JWPs</a>
      </h2>
<p id="appendix-A-1">The following examples use algorithms defined in JSON Proof Algorithms
and also contain the keys used, so that implementations can validate
these samples.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="example-json-serialized-single-use-jwp">
<section id="appendix-A.1">
        <h3 id="name-example-json-serialized-sin">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-example-json-serialized-sin" class="section-name selfRef">Example JSON-Serialized Single-Use JWP</a>
        </h3>
<p id="appendix-A.1-1">This example uses the Single-Use Algorithm as defined in JSON Proof
Algorithms to create a JSON Proof Token.  It demonstrates how to apply
selective disclosure using an array of traditional JWS-based signatures.
Unlinkability is only achieved by using each JWP one time, as multiple
uses are inherently linkable via the traditional ECDSA signature
embedded in the proof.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">To begin, we need two asymmetric keys for Single Use: one that
represents the JPT Issuer's stable key and the other is an ephemeral key
generated by the Issuer just for this JWP.<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1-3">This is the Issuer's stable private key used in this example in the JWK
format:<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<span id="name-issuer-private-key-es256-in"></span><figure id="figure-1">
          <div class="lang-wrapped sourcecode" id="appendix-A.1-4.1">
<pre>{
  "kty": "EC",
  "crv": "P-256",
  "x": "9rKM0b7L5H6JqYJdPm-3M6xW4mVr0ldCm1Yfyk0f6Fg",
  "y": "WFJgHxuB1xbXblcRcGIxap6M2cw3UNU7vA0FaSnBps8",
  "d": "Rbuuq8T0XlSB9PpcCS1NsIbnew0bbBZ16oi6Mv4hUZI"
}

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-issuer-private-key-es256-in" class="selfRef">Issuer Private Key (ES256 in JWK)</a>
          </figcaption></figure>
<p id="appendix-A.1-5">This is the ephemeral private key used in this example in the JWK
format:<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
<span id="name-issuer-ephemeral-private-ke"></span><figure id="figure-2">
          <div class="lang-wrapped sourcecode" id="appendix-A.1-6.1">
<pre>{
  "kty": "EC",
  "crv": "P-256",
  "x": "5gSyARLHWbTDK4Mi9LCotcrcCkyPxM9cxm1E6DEbSbg",
  "y": "DaXSe3rYJgePeYJDNHTtru5FINkztVYXXcGL8WFSP9E",
  "d": "aHnZUW8LEbFK8jHnFAf67mglWqMy9gxPGow-4g9SG7U"
}

</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-issuer-ephemeral-private-ke" class="selfRef">Issuer Ephemeral Private Key (ES256 in JWK)</a>
          </figcaption></figure>
<p id="appendix-A.1-7">This is the Holder's presentation private key used in this example in
the JWK format:<a href="#appendix-A.1-7" class="pilcrow">¶</a></p>
<span id="name-holder-presentation-private"></span><figure id="figure-3">
          <div class="lang-wrapped sourcecode" id="appendix-A.1-8.1">
<pre>{
  "kty": "EC",
  "crv": "P-256",
  "x": "UDGPPdLvm6zaJD1cy5TqJT4jM7qiEjzL2xe_JR6HNTI",
  "y": "1hC3bovYDN1uEouSjgeEHtS2X9CwCvOJ9cBdp6uYZ3g",
  "d": "0bk1ZcrPg4Nk8a4lmCKEuC57kywI7IvJ8qpzU-3UkY4"
}

</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-holder-presentation-private" class="selfRef">Holder Presentation Private Key (ES256 in JWK)</a>
          </figcaption></figure>
<p id="appendix-A.1-9">The JWP Protected Header declares that the data structure is a JPT and
the JWP Proof Input is secured using the Single-Use ECDSA algorithm with
the P-256 curve and SHA-256 digest.  It also includes the ephemeral
public key, the Holder's presentation public key and list of claims used
for this JPT.<a href="#appendix-A.1-9" class="pilcrow">¶</a></p>
<span id="name-issuer-protected-header-su-"></span><figure id="figure-4">
          <div class="lang-wrapped sourcecode" id="appendix-A.1-10.1">
<pre>{
  "alg": "SU-ES256",
  "typ": "JPT",
  "iss": "https://issuer.example",
  "hpa": "ES256",
  "claims": [
    "iat",
    "exp",
    "family_name",
    "given_name",
    "email",
    "address",
    "age_over_21"
  ],
  "proof_key": {
    "kty": "EC",
    "crv": "P-256",
    "x": "5gSyARLHWbTDK4Mi9LCotcrcCkyPxM9cxm1E6DEbSbg",
    "y": "DaXSe3rYJgePeYJDNHTtru5FINkztVYXXcGL8WFSP9E"
  },
  "presentation_key": {
    "kty": "EC",
    "crv": "P-256",
    "x": "UDGPPdLvm6zaJD1cy5TqJT4jM7qiEjzL2xe_JR6HNTI",
    "y": "1hC3bovYDN1uEouSjgeEHtS2X9CwCvOJ9cBdp6uYZ3g"
  }
}

</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-issuer-protected-header-su-" class="selfRef">Issuer Protected header (SU-ES256, JSON)</a>
          </figcaption></figure>
<span id="name-encoded-issuer-protected-he"></span><figure id="figure-5">
          <div class="lang-wrapped sourcecode" id="appendix-A.1-11.1">
<pre>eyJhbGciOiJTVS1FUzI1NiIsInR5cCI6IkpQVCIsImlzcyI6Imh0dHBzOi8vaXNzdWVyL
mV4YW1wbGUiLCJocGEiOiJFUzI1NiIsImNsYWltcyI6WyJpYXQiLCJleHAiLCJmYW1pbH
lfbmFtZSIsImdpdmVuX25hbWUiLCJlbWFpbCIsImFkZHJlc3MiLCJhZ2Vfb3Zlcl8yMSJ
dLCJwcm9vZl9rZXkiOnsia3R5IjoiRUMiLCJjcnYiOiJQLTI1NiIsIngiOiI1Z1N5QVJM
SFdiVERLNE1pOUxDb3RjcmNDa3lQeE05Y3htMUU2REViU2JnIiwieSI6IkRhWFNlM3JZS
mdlUGVZSkROSFR0cnU1RklOa3p0VllYWGNHTDhXRlNQOUUifSwicHJlc2VudGF0aW9uX2
tleSI6eyJrdHkiOiJFQyIsImNydiI6IlAtMjU2IiwieCI6IlVER1BQZEx2bTZ6YUpEMWN
5NVRxSlQ0ak03cWlFanpMMnhlX0pSNkhOVEkiLCJ5IjoiMWhDM2JvdllETjF1RW91U2pn
ZUVIdFMyWDlDd0N2T0o5Y0JkcDZ1WVozZyJ9fQ

</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-encoded-issuer-protected-he" class="selfRef">Encoded Issuer Protected Header (SU-ES256, JSON, encoded)</a>
          </figcaption></figure>
<p id="appendix-A.1-12">The Single Use algorithm utilizes multiple individual JWS Signatures.
Each signature value is generated by creating a JWS with a single
Protected Header with the associated <code>alg</code> value.  In this example, the
fixed header used for each JWS is the serialized JSON Object
<code>{"alg":"ES256"}</code>.  This protected header will be used to generate a
signature over each corresponding payload in the JWP.  The corresponding
octet value in the proof is the octet string (base64url-decoded) value
of the signature.<a href="#appendix-A.1-12" class="pilcrow">¶</a></p>
<p id="appendix-A.1-13">The final proof value from the Issuer is an array with the octets of the
header signature, followed by entries for each payload signature.<a href="#appendix-A.1-13" class="pilcrow">¶</a></p>
<span id="name-issuer-payloads-json-as-arr"></span><figure id="figure-6">
          <div class="lang-json sourcecode" id="appendix-A.1-14.1">
<pre>[
    1714521600,
    1717199999,
    "Doe",
    "Jay",
    "jaydoe@example.org",
    {
        "formatted": "1234 Main St.\nAnytown, CA 12345\nUSA",
        "street_address": "1234 Main St.",
        "locality": "Anytown",
        "region": "CA",
        "postal_code": 12345,
        "country": "USA"
    },
    true
]

</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-issuer-payloads-json-as-arr" class="selfRef">Issuer payloads (JSON, as array)</a>
          </figcaption></figure>
<p id="appendix-A.1-15">The compact serialization of the same JPT is:<a href="#appendix-A.1-15" class="pilcrow">¶</a></p>
<span id="name-issued-jwp-su-es256-json-co"></span><figure id="figure-7">
          <div class="lang-wrapped sourcecode" id="appendix-A.1-16.1">
<pre>eyJhbGciOiJTVS1FUzI1NiIsInR5cCI6IkpQVCIsImlzcyI6Imh0dHBzOi8vaXNzdWVyL
mV4YW1wbGUiLCJocGEiOiJFUzI1NiIsImNsYWltcyI6WyJpYXQiLCJleHAiLCJmYW1pbH
lfbmFtZSIsImdpdmVuX25hbWUiLCJlbWFpbCIsImFkZHJlc3MiLCJhZ2Vfb3Zlcl8yMSJ
dLCJwcm9vZl9rZXkiOnsia3R5IjoiRUMiLCJjcnYiOiJQLTI1NiIsIngiOiI1Z1N5QVJM
SFdiVERLNE1pOUxDb3RjcmNDa3lQeE05Y3htMUU2REViU2JnIiwieSI6IkRhWFNlM3JZS
mdlUGVZSkROSFR0cnU1RklOa3p0VllYWGNHTDhXRlNQOUUifSwicHJlc2VudGF0aW9uX2
tleSI6eyJrdHkiOiJFQyIsImNydiI6IlAtMjU2IiwieCI6IlVER1BQZEx2bTZ6YUpEMWN
5NVRxSlQ0ak03cWlFanpMMnhlX0pSNkhOVEkiLCJ5IjoiMWhDM2JvdllETjF1RW91U2pn
ZUVIdFMyWDlDd0N2T0o5Y0JkcDZ1WVozZyJ9fQ.MTcxNDUyMTYwMA~MTcxNzE5OTk5OQ~
IkRvZSI~IkpheSI~ImpheWRvZUBleGFtcGxlLm9yZyI~eyJmb3JtYXR0ZWQiOiIxMjM0I
E1haW4gU3QuXG5Bbnl0b3duLCBDQSAxMjM0NVxuVVNBIiwic3RyZWV0X2FkZHJlc3MiOi
IxMjM0IE1haW4gU3QuIiwibG9jYWxpdHkiOiJBbnl0b3duIiwicmVnaW9uIjoiQ0EiLCJ
wb3N0YWxfY29kZSI6MTIzNDUsImNvdW50cnkiOiJVU0EifQ~dHJ1ZQ.jFpOVWnvt1pP5O
gAnA0gAkdCB30vVr2GHyPSvBDa139aLyZ0aJS2EPCZe_PdI1Oqf6eCDOJdZR8XERrUwwq
GYQ~un-6LwYr-nebbahCNQr0vowwRA-T6VKEYwtkcq0085omErLjQQ5gdNzUMxopiDcdZ
xmFI1DJXc5C2xBJoxp50g~_-bK314uQ-Fmj36qAoMkxsaNzfXOTGIumQyqqPcAcsQajqq
sC2AZDgdHasbpNc-xcfm0aqlHUeJKK5eTeQGskQ~6h76LNuIkCYnQe-bizsvRTseuiQeA
qMYuDbbWEokxf8Z5VJrfQ2Vr_JOgjurSeajwvoC099MAKOiZ7dDz-Bf-g~mI7RmEn5aC4
sFhFcYyNGhTv6sEg4no6kXUmIReEi6zbw0yIzDUiRqEdp9dqbWoijobVY7pIwha8vT44T
bmFPbA~Wzkggvoy486_exmm_3RXSWOztgRtnfMbgylYKaRaUZ7aC2qZb90OluOtbeTgYc
-LgV9qW7_Kh8nj5BrXVFlmog~rVrjkEeQbUJA_JIWpHyMp9Lbv0va8ZSV2MOfkkqa702l
YSL5wI4zhYeyJIKBMA8r2Y-Qq4ZMD94utL-DXbOIeg~eDAg_o-EonVDP8oVbxqJkadj3r
MZQCWnPo4UmLtQrQy2AhEzpkBZPK3HIJ3Koo5AqZnM7ZtFWorzUpHECUwAUw

</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-issued-jwp-su-es256-json-co" class="selfRef">Issued JWP (SU-ES256, JSON, Compact Serialization)</a>
          </figcaption></figure>
<p id="appendix-A.1-17">To present this JPT, we first use the following presentation header with
a nonce (provided by the Verifier):<a href="#appendix-A.1-17" class="pilcrow">¶</a></p>
<span id="name-presentation-header-su-es25"></span><figure id="figure-8">
          <div class="lang-wrapped sourcecode" id="appendix-A.1-18.1">
<pre>{
  "alg": "SU-ES256",
  "aud": "https://recipient.example.com",
  "nonce": "L8_iAhvN0UDqoxvQwLNMPffq-ZOsIBqSoNtINwmIxHM"
}

</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-presentation-header-su-es25" class="selfRef">Presentation Header (SU-ES256, JSON)</a>
          </figcaption></figure>
<span id="name-presentation-header-su-es256"></span><figure id="figure-9">
          <div class="lang-wrapped sourcecode" id="appendix-A.1-19.1">
<pre>eyJhbGciOiJTVS1FUzI1NiIsImF1ZCI6Imh0dHBzOi8vcmVjaXBpZW50LmV4YW1wbGUuY
29tIiwibm9uY2UiOiJMOF9pQWh2TjBVRHFveHZRd0xOTVBmZnEtWk9zSUJxU29OdElOd2
1JeEhNIn0

</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-presentation-header-su-es256" class="selfRef">Presentation Header (SU-ES256, JSON, Base64url-Encoded)</a>
          </figcaption></figure>
<p id="appendix-A.1-20">We apply selective disclosure of only the given name and age claims
(family name and email hidden), and remove the proof components
corresponding to these entries.<a href="#appendix-A.1-20" class="pilcrow">¶</a></p>
<p id="appendix-A.1-21">Using the selectively disclosed information, we generate the
presentation internal representation.  Using that and the selectively
disclosed payloads, we get the following presented JPT in compact
serialization:<a href="#appendix-A.1-21" class="pilcrow">¶</a></p>
<div class="lang-wrapped sourcecode" id="appendix-A.1-22">
<pre>eyJhbGciOiJTVS1FUzI1NiIsImF1ZCI6Imh0dHBzOi8vcmVjaXBpZW50LmV4YW1wbGUuY
29tIiwibm9uY2UiOiJMOF9pQWh2TjBVRHFveHZRd0xOTVBmZnEtWk9zSUJxU29OdElOd2
1JeEhNIn0.eyJhbGciOiJTVS1FUzI1NiIsInR5cCI6IkpQVCIsImlzcyI6Imh0dHBzOi8
vaXNzdWVyLmV4YW1wbGUiLCJocGEiOiJFUzI1NiIsImNsYWltcyI6WyJpYXQiLCJleHAi
LCJmYW1pbHlfbmFtZSIsImdpdmVuX25hbWUiLCJlbWFpbCIsImFkZHJlc3MiLCJhZ2Vfb
3Zlcl8yMSJdLCJwcm9vZl9rZXkiOnsia3R5IjoiRUMiLCJjcnYiOiJQLTI1NiIsIngiOi
I1Z1N5QVJMSFdiVERLNE1pOUxDb3RjcmNDa3lQeE05Y3htMUU2REViU2JnIiwieSI6IkR
hWFNlM3JZSmdlUGVZSkROSFR0cnU1RklOa3p0VllYWGNHTDhXRlNQOUUifSwicHJlc2Vu
dGF0aW9uX2tleSI6eyJrdHkiOiJFQyIsImNydiI6IlAtMjU2IiwieCI6IlVER1BQZEx2b
TZ6YUpEMWN5NVRxSlQ0ak03cWlFanpMMnhlX0pSNkhOVEkiLCJ5IjoiMWhDM2JvdllETj
F1RW91U2pnZUVIdFMyWDlDd0N2T0o5Y0JkcDZ1WVozZyJ9fQ.MTcxNDUyMTYwMA~MTcxN
zE5OTk5OQ~IkRvZSI~IkpheSI~ImpheWRvZUBleGFtcGxlLm9yZyI~eyJmb3JtYXR0ZWQ
iOiIxMjM0IE1haW4gU3QuXG5Bbnl0b3duLCBDQSAxMjM0NVxuVVNBIiwic3RyZWV0X2Fk
ZHJlc3MiOiIxMjM0IE1haW4gU3QuIiwibG9jYWxpdHkiOiJBbnl0b3duIiwicmVnaW9uI
joiQ0EiLCJwb3N0YWxfY29kZSI6MTIzNDUsImNvdW50cnkiOiJVU0EifQ~dHJ1ZQ~~.jF
pOVWnvt1pP5OgAnA0gAkdCB30vVr2GHyPSvBDa139aLyZ0aJS2EPCZe_PdI1Oqf6eCDOJ
dZR8XERrUwwqGYQ~un-6LwYr-nebbahCNQr0vowwRA-T6VKEYwtkcq0085omErLjQQ5gd
NzUMxopiDcdZxmFI1DJXc5C2xBJoxp50g~_-bK314uQ-Fmj36qAoMkxsaNzfXOTGIumQy
qqPcAcsQajqqsC2AZDgdHasbpNc-xcfm0aqlHUeJKK5eTeQGskQ~6h76LNuIkCYnQe-bi
zsvRTseuiQeAqMYuDbbWEokxf8Z5VJrfQ2Vr_JOgjurSeajwvoC099MAKOiZ7dDz-Bf-g
~mI7RmEn5aC4sFhFcYyNGhTv6sEg4no6kXUmIReEi6zbw0yIzDUiRqEdp9dqbWoijobVY
7pIwha8vT44TbmFPbA~Wzkggvoy486_exmm_3RXSWOztgRtnfMbgylYKaRaUZ7aC2qZb9
0OluOtbeTgYc-LgV9qW7_Kh8nj5BrXVFlmog~JI2ihUf7f85b0d0GiY-JFBzoOStcc13w
QizgwxEdk3uAbOAvADhyAQHfaMtRUdCrCRpa4fpMre4h5d_Gzj0pxA

</pre><a href="#appendix-A.1-22" class="pilcrow">¶</a>
</div>
<blockquote id="appendix-A.1-23">
          <p id="appendix-A.1-23.1">Figure: Presentation (SU-ES256, JSON, Compact Serialization)<a href="#appendix-A.1-23.1" class="pilcrow">¶</a></p>
</blockquote>
</section>
</div>
<div id="example-cbor-serialized-single-use-cpt">
<section id="appendix-A.2">
        <h3 id="name-example-cbor-serialized-sin">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-example-cbor-serialized-sin" class="section-name selfRef">Example CBOR-Serialized Single-Use CPT</a>
        </h3>
<p id="appendix-A.2-1">This example is meant to mirror the prior compact serialization, using
<a href="CWT">RFC8392</a> and claims from <span>[<a href="#I-D.maldant-spice-oidc-cwt" class="cite xref">I-D.maldant-spice-oidc-cwt</a>]</span>,
illustrated using <span>[<a href="#I-D.ietf-cbor-edn-literals" class="cite xref">I-D.ietf-cbor-edn-literals</a>]</span> (EDN).<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">To simplify this example, the same information is represented as the JPT
example above, including the same public and private keys.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<div class="lang-edn sourcecode" id="appendix-A.2-3">
<pre>
{          / protected header /
  1: 1,     / alg: "SU-ES256" /
  3: 20,    / typ: "JPT" (20CPA) /
  5: "https://issuer.example",  / iss: "https://issuer.example" /
  6: [      / claims /
    6,      / "iat" /
    4,      / "exp" /
    170,    / "family_name" (I-D.maldant-spice-oidc-cwt TBD1) /
    171,    / "given_name"  (I-D.maldant-spice-oidc-cwt TBD2) /
    179,    / "email"       (I-D.maldant-spice-oidc-cwt TBD10) /
    187,    / "address"     (I-D.maldant-spice-oidc-cwt TBD18) /
    "age_over_21"
  ],
  8: {      / proof key /
    1: 2,   / kty : "EC2" /
    -1: 1,  / crv: "P-256" /
    -2: h'50318f3dd2ef9bacda243d5ccb94ea253e2333baa2123ccbdb17bf25' +
        h'1e873532', / x /
    -3: h'd610b76e8bd80cdd6e128b928e07841ed4b65fd0b00af389f5c05da7' +
        h'ab986778'  / y /
  },
  9: {      / presentation key /
    1: 2,   / kty: "EC2" /
    -1: 1,  / crv: "P-256" /
    -2: h'e604b20112c759b4c32b8322f4b0a8b5cadc0a4c8fc4cf5cc66d44e8' +
        h'311b49b8', / x /
    -3: h'0da5d27b7ad826078f7982433474edaeee4520d933b556175dc18bf1' +
        h'61523fd1'  / y /
  },
  10: -9    / hpa: "ESP256" (I-D.ietf-jose-fully-specified-algorithms TBD-9) /
}

</pre><a href="#appendix-A.2-3" class="pilcrow">¶</a>
</div>
<blockquote id="appendix-A.2-4">
          <p id="appendix-A.2-4.1">Figure: Issuer Protected Header (SU-ES256, CBOR)<a href="#appendix-A.2-4.1" class="pilcrow">¶</a></p>
</blockquote>
<div class="lang-edn sourcecode" id="appendix-A.2-5">
<pre>[ / payloads    /
  / iat         / 171452160,
  / exp         / 171719999,
  / family_name / "Doe",
  / given_name  / "Jay",
  / email       / "jaydoe@example.org",
  / address     / {
    / formatted / 1: "1234 Main St.\nAnytown, CA 12345\nUSA",
    / street    / 2: "1234 Main St.",
    / locality  / 3: "Anytown",
    / region    / 4: "CA",
    / post code / 5: "90210",
    / country   / 6: "USA"
  },
  / age_over_21 / true
]

</pre><a href="#appendix-A.2-5" class="pilcrow">¶</a>
</div>
<blockquote id="appendix-A.2-6">
          <p id="appendix-A.2-6.1">Figure: Issuer Payloads (as CBOR array)<a href="#appendix-A.2-6.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="appendix-A.2-7">When signed and serialized, the CPT is represented by the following CBOR
(in hex):<a href="#appendix-A.2-7" class="pilcrow">¶</a></p>
<div class="lang-hex sourcecode" id="appendix-A.2-8">
<pre>8358cfa701010314057668747470733a2f2f6973737565722e6578616d706c65
0687060418aa18ab18b318bb6b6167655f6f7665725f323108a4010220012158
2050318f3dd2ef9bacda243d5ccb94ea253e2333baa2123ccbdb17bf251e8735
32225820d610b76e8bd80cdd6e128b928e07841ed4b65fd0b00af389f5c05da7
ab98677809a401022001215820e604b20112c759b4c32b8322f4b0a8b5cadc0a
4c8fc4cf5cc66d44e8311b49b82258200da5d27b7ad826078f7982433474edae
ee4520d933b556175dc18bf161523fd10a28871a0a3827001a0a3c3d3f63446f
65634a6179726a6179646f65406578616d706c652e6f7267a601782331323334
204d61696e2053742e0a416e79746f776e2c2043412031323334350a55534102
6d31323334204d61696e2053742e0367416e79746f776e046243410565393032
31300663555341f588584040947078ef28a7c92482eeb42b0d0159dab5715bed
e5d7c88fb062ee8645715d69971a564035c70ea19f4382dfe3e2cbb7f2113caf
c78a31e3dff6684083f92f5840e7280664ec4dd2b64d25bc9b1d28280ae64ceb
9bfa348ddb4660b12612e53d4d35a8b9a25774462ddf3968b7c0428b3546540b
55aba204636aa76a9c86cc816f584048f7531304fe9e26d1b4da5f52621f675c
1fecf3ee786e58e7e9e4cedd34e55f095768e2265e549ea3aa31a343c1246578
a729eee8c30de05ab76332ab4e315758408802dd3d9f09a594107a3242350dd8
981c3cff03fca6e40c9f36c32650170f1b2caddbf06fbdc3792cc7dc18fb0dae
8c2c6dbc82571ad3bea0e070a0875a5301584099357af7ac203d65be1ee33c58
6e17d8a02c48ab13be3b2e1afd9af401a3e9c85abab4c2cb0f60cfe4982d4b89
1eb778d7e0dc39620185332eb6471c07a23b0f584081b952941fa39a09faf263
7eb6f4608af507dfef0f73208c1b3839c4146b1639cc5ead436ab1a9cd7ed5ae
467bfc8a917e723e9655123e37fb76ea129aeb17b95840de80f0df11cb20a829
1c23eabc2942cb0e327e66f7f04149398eeb006fb8387db0defef52feed512b7
3c7075cc0bce38633090ee86aa71e633e7c188b869ee575840eb3c2a05455a38
e4b0b3165c4dd7132d633c79de242fd6d6a197b9cf47c02f9a0f0ec39886b350
9920aabaa4140424d91c7565611733e9ca6d3e2159f20c1d85

</pre><a href="#appendix-A.2-8" class="pilcrow">¶</a>
</div>
<blockquote id="appendix-A.2-9">
          <p id="appendix-A.2-9.1">Fixtures: Issued Form (SU-ES256, CBOR)<a href="#appendix-A.2-9.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="appendix-A.2-10">The presented form, similarly to the issued form above, is made with the
holder conveying the same parameters and the same set of selectively
disclosed payloads as the JPT above:<a href="#appendix-A.2-10" class="pilcrow">¶</a></p>
<div class="lang-edn sourcecode" id="appendix-A.2-11">
<pre>{          / protected header /
  1: 1,    / alg: "SU-ES256" /
  6: "https://recipient.example.com", / aud /
  7: h'2fcfe2021bcdd140eaa31bd0c0b34c3df7eaf993ac201a92a0db48370988c473', / nonce /
}

</pre><a href="#appendix-A.2-11" class="pilcrow">¶</a>
</div>
<blockquote id="appendix-A.2-12">
          <p id="appendix-A.2-12.1">Figure: Holder Protected Header (SU-ES256, CBOR)<a href="#appendix-A.2-12.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="appendix-A.2-13">When the appropriate proof is generated, the CPT is serialized into the
following CBOR (in hex):<a href="#appendix-A.2-13" class="pilcrow">¶</a></p>
<div class="lang-hex sourcecode" id="appendix-A.2-14">
<pre>845846a3010106781d68747470733a2f2f726563697069656e742e6578616d70
6c652e636f6d0758202fcfe2021bcdd140eaa31bd0c0b34c3df7eaf993ac201a
92a0db48370988c47358cfa701010314057668747470733a2f2f697373756572
2e6578616d706c650687060418aa18ab18b318bb6b6167655f6f7665725f3231
08a40102200121582050318f3dd2ef9bacda243d5ccb94ea253e2333baa2123c
cbdb17bf251e873532225820d610b76e8bd80cdd6e128b928e07841ed4b65fd0
b00af389f5c05da7ab98677809a401022001215820e604b20112c759b4c32b83
22f4b0a8b5cadc0a4c8fc4cf5cc66d44e8311b49b82258200da5d27b7ad82607
8f7982433474edaeee4520d933b556175dc18bf161523fd10a28891a0a382700
1a0a3c3d3f63446f65634a6179726a6179646f65406578616d706c652e6f7267
a601782331323334204d61696e2053742e0a416e79746f776e2c204341203132
3334350a555341026d31323334204d61696e2053742e0367416e79746f776e04
624341056539303231300663555341f5f6f687584040947078ef28a7c92482ee
b42b0d0159dab5715bede5d7c88fb062ee8645715d69971a564035c70ea19f43
82dfe3e2cbb7f2113cafc78a31e3dff6684083f92f5840e7280664ec4dd2b64d
25bc9b1d28280ae64ceb9bfa348ddb4660b12612e53d4d35a8b9a25774462ddf
3968b7c0428b3546540b55aba204636aa76a9c86cc816f584048f7531304fe9e
26d1b4da5f52621f675c1fecf3ee786e58e7e9e4cedd34e55f095768e2265e54
9ea3aa31a343c1246578a729eee8c30de05ab76332ab4e315758408802dd3d9f
09a594107a3242350dd8981c3cff03fca6e40c9f36c32650170f1b2caddbf06f
bdc3792cc7dc18fb0dae8c2c6dbc82571ad3bea0e070a0875a5301584099357a
f7ac203d65be1ee33c586e17d8a02c48ab13be3b2e1afd9af401a3e9c85abab4
c2cb0f60cfe4982d4b891eb778d7e0dc39620185332eb6471c07a23b0f584081
b952941fa39a09faf2637eb6f4608af507dfef0f73208c1b3839c4146b1639cc
5ead436ab1a9cd7ed5ae467bfc8a917e723e9655123e37fb76ea129aeb17b958
406c7c68bd30495ffaede6c65f6fd326524a4b4307e8a41ffabd63b2142a1cbc
98ce5028115ab35bfb736bbd6e7ecaa1329870e8ada6600b1855ea3e7087144e
2d

</pre><a href="#appendix-A.2-14" class="pilcrow">¶</a>
</div>
<blockquote id="appendix-A.2-15">
          <p id="appendix-A.2-15.1">Figure: Presented Form (SU-ES256, CBOR)<a href="#appendix-A.2-15.1" class="pilcrow">¶</a></p>
</blockquote>
</section>
</div>
<div id="example-bbs-jwp">
<section id="appendix-A.3">
        <h3 id="name-example-bbs-jwp">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-example-bbs-jwp" class="section-name selfRef">Example BBS JWP</a>
        </h3>
<p id="appendix-A.3-1">The following example uses the <code>BBS</code> algorithm.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3-2">This is the Issuer's stable private key in the JWK format:<a href="#appendix-A.3-2" class="pilcrow">¶</a></p>
<span id="name-bbs-private-key-in-jwk-form"></span><figure id="figure-10">
          <div class="lang-wrapped sourcecode" id="appendix-A.3-3.1">
<pre>{
  "kty": "EC2",
  "alg": "BBS",
  "use": "proof",
  "crv": "BLS12381G2",
  "x": "EXGppDwjOOJgcQ5GuLQRa0cMmIYHMFuVT0kwJdSzK8FJL_zLCoLLhv9KVDXUH
       P58FC-cZf9AssitObgO7RwcDCRy3YCdFj_Q5ppPhzq_0f9V7AVTHNsNDKhKIN0
       sBT8u",
  "y": "C1J_cUazABViCggv94HIikg57YCf-IxXMPYQ0mL1z_d-w5g3i1hfiGneOYGUZ
       PG0Ci7NIihtmNvNx1nDBLE7UMXHEsDhP9yR06nX94Ey4pawI_D6wg8-a_zANWL
       PEfXo",
  "d": "PEFtTj81N6H9wSlGQaYAIrvOc-rARUGRX7zprEXfuiE"
}

</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-bbs-private-key-in-jwk-form" class="selfRef">BBS private key in JWK format</a>
          </figcaption></figure>
<p id="appendix-A.3-4">There is no additional holder key necessary for presentation proofs.<a href="#appendix-A.3-4" class="pilcrow">¶</a></p>
<p id="appendix-A.3-5">For the following protected header and array of payloads:<a href="#appendix-A.3-5" class="pilcrow">¶</a></p>
<span id="name-example-issuer-protected-he"></span><figure id="figure-11">
          <div class="lang-json sourcecode" id="appendix-A.3-6.1">
<pre>{
  "kid": "HjfcpyjuZQ-O8Ye2hQnNbT9RbbnrobptdnExR0DUjU8",
  "alg": "BBS"
}

</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-example-issuer-protected-he" class="selfRef">Example issuer protected header</a>
          </figcaption></figure>
<p id="appendix-A.3-7">These components are signed using the private issuer key previously
given, which is then representable in the following serialization:<a href="#appendix-A.3-7" class="pilcrow">¶</a></p>
<span id="name-issued-jwp-bbs-json-compact"></span><figure id="figure-12">
          <div class="lang-wrapped sourcecode" id="appendix-A.3-8.1">
<pre>eyJraWQiOiJIamZjcHlqdVpRLU84WWUyaFFuTmJUOVJiYm5yb2JwdGRuRXhSMERValU4I
iwiYWxnIjoiQkJTIn0.MTcxNDUyMTYwMA~MTcxNzE5OTk5OQ~IkRvZSI~IkpheSI~Imph
eWRvZUBleGFtcGxlLm9yZyI~eyJmb3JtYXR0ZWQiOiIxMjM0IE1haW4gU3QuXG5Bbnl0b
3duLCBDQSAxMjM0NVxuVVNBIiwic3RyZWV0X2FkZHJlc3MiOiIxMjM0IE1haW4gU3QuIi
wibG9jYWxpdHkiOiJBbnl0b3duIiwicmVnaW9uIjoiQ0EiLCJwb3N0YWxfY29kZSI6MTI
zNDUsImNvdW50cnkiOiJVU0EifQ~dHJ1ZQ.sUwFMqNNhtbr3_MM1Rp863BfMCx55ixxel
FLGGJaudmRfsrY7mpC7pQ-j5yyRlTFBAABeTePIXon7WqtNYf0iwIaYIG6lkzGqNyydR4
Xl_8

</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-issued-jwp-bbs-json-compact" class="selfRef">Issued JWP (BBS, JSON, Compact Serialization)</a>
          </figcaption></figure>
<p id="appendix-A.3-9">For a presentation with the following presentation header:<a href="#appendix-A.3-9" class="pilcrow">¶</a></p>
<span id="name-holder-presentation-header"></span><figure id="figure-13">
          <div class="lang-json sourcecode" id="appendix-A.3-10.1">
<pre>{
    "alg": "BBS",
    "aud": "https://recipient.example.com",
    "nonce": "wrmBRkKtXjQ"
}

</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-holder-presentation-header" class="selfRef">Holder Presentation Header</a>
          </figcaption></figure>
<p id="appendix-A.3-11">The holder decides to share all information other than the email
address, and generates a proof.  That proof is represented in the
following serialization:<a href="#appendix-A.3-11" class="pilcrow">¶</a></p>
<span id="name-presentation-jwp-bbs-json-c"></span><figure id="figure-14">
          <div class="lang-wrapped sourcecode" id="appendix-A.3-12.1">
<pre>eyJhbGciOiJCQlMiLCJhdWQiOiJodHRwczovL3JlY2lwaWVudC5leGFtcGxlLmNvbSIsI
m5vbmNlIjoid3JtQlJrS3RYalEifQ.eyJraWQiOiJIamZjcHlqdVpRLU84WWUyaFFuTmJ
UOVJiYm5yb2JwdGRuRXhSMERValU4IiwiYWxnIjoiQkJTIn0.MTcxNDUyMTYwMA~MTcxN
zE5OTk5OQ~IkRvZSI~IkpheSI~~~.kqbkCKoQYCF_ZHrVhTB6JUneALywrK6zvQZ8D5TQ
SyKFFdGH6c2c-KFWDVlOt9QQpqUp8y0ttFdj_GGJSet67ZwXoSyjpuJu-_hoHCT0yGP2g
Ztnz-VxBQ3Gw0edSlGml0EQGYgdn73YaRDAUHAKnNbeR1qTG5kVsalprRnAIvfEPoQ0yn
xmz_nf6mRLcZWLE4HtN4bbBW-MPp_PrcU1nGSLTOxrt67uXDm8D-SUv9gsZ92Z5Wa7YDB
xDIYhl8lFKuLIsBFbO53Bm6_7bjjwe1YqbEFwVdkOO_dsAczhCQLwOxRU0HHQmepHE_Gr
PPTxTrtMSO-m3eiUCJCZOxGK-dYvsf8VM6e6QtDRuZ3W5VYlznRjNyDvhH0rxreFkGyLt
JUD6jf6uUn44p_FH3ViDwnStyslmYWbMWcnTRHXvd6EbmCWnN_ZHWPTBFgE12wYVasoKY
4qtpDHyIEr4A1GBO_eWE9frAR7OCNlFwxUTrI

</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-presentation-jwp-bbs-json-c" class="selfRef">Presentation JWP (BBS, JSON, Compact serialization)</a>
          </figcaption></figure>
</section>
</div>
<div id="example-mac-jwp">
<section id="appendix-A.4">
        <h3 id="name-example-mac-jwp">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-example-mac-jwp" class="section-name selfRef">Example MAC JWP</a>
        </h3>
<p id="appendix-A.4-1">The following example uses the <code>MAC-H256</code> algorithm.<a href="#appendix-A.4-1" class="pilcrow">¶</a></p>
<p id="appendix-A.4-2">This is the Issuer's stable private key in the JWK format:<a href="#appendix-A.4-2" class="pilcrow">¶</a></p>
<span id="name-issuer-private-key"></span><figure id="figure-15">
          <div class="lang-wrapped sourcecode" id="appendix-A.4-3.1">
<pre>{
  "kty": "EC",
  "crv": "P-256",
  "x": "9rKM0b7L5H6JqYJdPm-3M6xW4mVr0ldCm1Yfyk0f6Fg",
  "y": "WFJgHxuB1xbXblcRcGIxap6M2cw3UNU7vA0FaSnBps8",
  "d": "Rbuuq8T0XlSB9PpcCS1NsIbnew0bbBZ16oi6Mv4hUZI"
}

</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-issuer-private-key" class="selfRef">Issuer private key</a>
          </figcaption></figure>
<p id="appendix-A.4-4">This is the Issuer's ephemerally generated shared secret:<a href="#appendix-A.4-4" class="pilcrow">¶</a></p>
<span id="name-shared-secret"></span><figure id="figure-16">
          <div class="lang-json sourcecode" id="appendix-A.4-5.1">
<pre>"ADDydqeGFHo2vo0w1spFFg4im7Lc-zpryxKT7IeUy5Y"

</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-shared-secret" class="selfRef">Shared Secret</a>
          </figcaption></figure>
<p id="appendix-A.4-6">This is the Holder's presentation private key in the JWK format:<a href="#appendix-A.4-6" class="pilcrow">¶</a></p>
<span id="name-holder-private-key"></span><figure id="figure-17">
          <div class="lang-wrapped sourcecode" id="appendix-A.4-7.1">
<pre>{
  "kty": "EC",
  "crv": "P-256",
  "x": "UDGPPdLvm6zaJD1cy5TqJT4jM7qiEjzL2xe_JR6HNTI",
  "y": "1hC3bovYDN1uEouSjgeEHtS2X9CwCvOJ9cBdp6uYZ3g",
  "d": "0bk1ZcrPg4Nk8a4lmCKEuC57kywI7IvJ8qpzU-3UkY4"
}

</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-holder-private-key" class="selfRef">Holder private key</a>
          </figcaption></figure>
<p id="appendix-A.4-8">For the following protected header and array of payloads:<a href="#appendix-A.4-8" class="pilcrow">¶</a></p>
<span id="name-example-issuer-protected-hea"></span><figure id="figure-18">
          <div class="lang-json sourcecode" id="appendix-A.4-9.1">
<pre>{
  "alg": "MAC-H256",
  "hpa": "ES256",
  "typ": "JPT",
  "iss": "https://issuer.example",
  "claims": [
    "iat",
    "exp",
    "family_name",
    "given_name",
    "email",
    "address",
    "age_over_21"
  ],
  "presentation_key": {
    "kty": "EC",
    "crv": "P-256",
    "use": "sign",
    "x": "UDGPPdLvm6zaJD1cy5TqJT4jM7qiEjzL2xe_JR6HNTI",
    "y": "1hC3bovYDN1uEouSjgeEHtS2X9CwCvOJ9cBdp6uYZ3g"
  }
}

</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-example-issuer-protected-hea" class="selfRef">Example issuer protected header</a>
          </figcaption></figure>
<span id="name-example-issuer-payloads-as-"></span><figure id="figure-19">
          <div class="lang-json sourcecode" id="appendix-A.4-10.1">
<pre>[
    1714521600,
    1717199999,
    "Doe",
    "Jay",
    "jaydoe@example.org",
    {
        "formatted": "1234 Main St.\nAnytown, CA 12345\nUSA",
        "street_address": "1234 Main St.",
        "locality": "Anytown",
        "region": "CA",
        "postal_code": 12345,
        "country": "USA"
    },
    true
]

</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-example-issuer-payloads-as-" class="selfRef">Example issuer payloads (as members of a JSON array)</a>
          </figcaption></figure>
<p id="appendix-A.4-11">The issuer generates an array of derived keys, one per payload slot.
This is done using the shared secret as the key and a binary value based
on the payload slot index (from zero) as input to the HMAC operation.<a href="#appendix-A.4-11" class="pilcrow">¶</a></p>
<p id="appendix-A.4-12">This results in the following set of derived keys:<a href="#appendix-A.4-12" class="pilcrow">¶</a></p>
<span id="name-derived-payload-keys-base64"></span><figure id="figure-20">
          <div class="lang-json sourcecode" id="appendix-A.4-13.1">
<pre>[
  "bpdUoU5cCf5UlM8jO39U_4E8RrSl2quc9umLfszFzbI",
  "gaF8-zHN7oogZRbuanajf0IjGuX2eRi0umMf5CSC9Yg",
  "Wy1J33l5qX6jjSDRhIIdeNA0Eo1f54JdhW90cuGgVCI",
  "R_NJq2y58bwJWFHPu4QQRXR0w_v-00W8Mk7QzPNYRpc",
  "DUsvobVyP4fFNnhLP6YnKJw4KnPKoLC_uR5iPJkYNa4",
  "JCRhvDRtF-YZuxveDFSf9IrldD2urinW3vcC5EZfsrw",
  "urdWvz61PsUqsVdKcq2P1bMGHxMufz1eMlEI-WLaBEk"
]

</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-derived-payload-keys-base64" class="selfRef">Derived payload keys (Base64url-Encoded)</a>
          </figcaption></figure>
<p id="appendix-A.4-14">A MAC is generated for each payload using the corresponding derived
payload key.  This results in the following set of MAC values:<a href="#appendix-A.4-14" class="pilcrow">¶</a></p>
<span id="name-payload-mac-values-base64ur"></span><figure id="figure-21">
          <div class="lang-json sourcecode" id="appendix-A.4-15.1">
<pre>[
  "GviV1lt_8KzGvX7gPhZvf76B3nws_9nZa6Np04RGj0c",
  "gfgEiqItw74RPqcQEnAFkubJmhX86S3hF3MDSED8TRc",
  "XWRewuhNAF-Xzv005dvi_kIBSyOEz3EOZINnENFnVcc",
  "JALEwwHnncoEkx5RbJ_cF5LUB9zhoOcsiXh-b_3nlwk",
  "FqzsvDIF2gRQC_Rh5Ws9MD4usaPRLvaE8S55LRPcG00",
  "rwQVbkklDBCsNdXVb3GCbBk4zWr6Ehu-QRioh7jVIXw",
  "ahYOdLdWr0Q0L429Lq0nZB3-hGYsi40Hh9w1M6vsfqI"
]

</pre>
</div>
<figcaption><a href="#figure-21" class="selfRef">Figure 21</a>:
<a href="#name-payload-mac-values-base64ur" class="selfRef">Payload MAC values (Base64url-Encoded)</a>
          </figcaption></figure>
<p id="appendix-A.4-16">The issuer protected header and payload MAC values are combined into a
binary representation known as the Compact MAC Representation.  This
representation is signed with the issuer's private key.<a href="#appendix-A.4-16" class="pilcrow">¶</a></p>
<p id="appendix-A.4-17">The proof consists of two octet string values: the signature over the
combined MAC representation, and the shared secret.<a href="#appendix-A.4-17" class="pilcrow">¶</a></p>
<span id="name-issued-proof-base64url-enco"></span><figure id="figure-22">
          <div class="lang-wrapped sourcecode" id="appendix-A.4-18.1">
<pre>[
  "UT9Qo7y_J2XfsufwFwU1Dur8TMXmwbdy62KPeDbdLhXSmZpa0nbjqYN8risZU8q7rs
T13AboPy6aTp-TjYK8mw",
  "XjkGGMyG6fgUF2hf5KiBiWoORS7vPmFuzzhDNAGrE58"
]

</pre>
</div>
<figcaption><a href="#figure-22" class="selfRef">Figure 22</a>:
<a href="#name-issued-proof-base64url-enco" class="selfRef">Issued Proof (Base64url-Encoded)</a>
          </figcaption></figure>
<p id="appendix-A.4-19">The final issued JWP in compact serialization is:<a href="#appendix-A.4-19" class="pilcrow">¶</a></p>
<span id="name-issued-jwp-mac-h256-json-co"></span><figure id="figure-23">
          <div class="lang-wrapped sourcecode" id="appendix-A.4-20.1">
<pre>eyJhbGciOiJNQUMtSDI1NiIsImhwYSI6IkVTMjU2IiwidHlwIjoiSlBUIiwiaXNzIjoia
HR0cHM6Ly9pc3N1ZXIuZXhhbXBsZSIsImNsYWltcyI6WyJpYXQiLCJleHAiLCJmYW1pbH
lfbmFtZSIsImdpdmVuX25hbWUiLCJlbWFpbCIsImFkZHJlc3MiLCJhZ2Vfb3Zlcl8yMSJ
dLCJwcmVzZW50YXRpb25fa2V5Ijp7Imt0eSI6IkVDIiwiY3J2IjoiUC0yNTYiLCJ1c2Ui
OiJzaWduIiwieCI6IlVER1BQZEx2bTZ6YUpEMWN5NVRxSlQ0ak03cWlFanpMMnhlX0pSN
khOVEkiLCJ5IjoiMWhDM2JvdllETjF1RW91U2pnZUVIdFMyWDlDd0N2T0o5Y0JkcDZ1WV
ozZyJ9fQ.MTcxNDUyMTYwMA~MTcxNzE5OTk5OQ~IkRvZSI~IkpheSI~ImpheWRvZUBleG
FtcGxlLm9yZyI~eyJmb3JtYXR0ZWQiOiIxMjM0IE1haW4gU3QuXG5Bbnl0b3duLCBDQSA
xMjM0NVxuVVNBIiwic3RyZWV0X2FkZHJlc3MiOiIxMjM0IE1haW4gU3QuIiwibG9jYWxp
dHkiOiJBbnl0b3duIiwicmVnaW9uIjoiQ0EiLCJwb3N0YWxfY29kZSI6MTIzNDUsImNvd
W50cnkiOiJVU0EifQ~dHJ1ZQ.UT9Qo7y_J2XfsufwFwU1Dur8TMXmwbdy62KPeDbdLhXS
mZpa0nbjqYN8risZU8q7rsT13AboPy6aTp-TjYK8mw~XjkGGMyG6fgUF2hf5KiBiWoORS
7vPmFuzzhDNAGrE58

</pre>
</div>
<figcaption><a href="#figure-23" class="selfRef">Figure 23</a>:
<a href="#name-issued-jwp-mac-h256-json-co" class="selfRef">Issued JWP (MAC-H256, JSON, Compact Serialization)</a>
          </figcaption></figure>
<p id="appendix-A.4-21">Next, we show the presentation of the JWP with selective disclosure.<a href="#appendix-A.4-21" class="pilcrow">¶</a></p>
<p id="appendix-A.4-22">For presentation with the following presentation protected header:<a href="#appendix-A.4-22" class="pilcrow">¶</a></p>
<span id="name-presentation-protected-header"></span><figure id="figure-24">
          <div class="lang-wrapped sourcecode" id="appendix-A.4-23.1">
<pre>{
  "alg": "MAC-H256",
  "aud": "https://recipient.example.com",
  "nonce": "L8_iAhvN0UDqoxvQwLNMPffq-ZOsIBqSoNtINwmIxHM"
}

</pre>
</div>
<figcaption><a href="#figure-24" class="selfRef">Figure 24</a>:
<a href="#name-presentation-protected-header" class="selfRef">Presentation Protected Header</a>
          </figcaption></figure>
<p id="appendix-A.4-24">The holder will take the issuer proof (including shared secret) and
derive the same individual payload MAC values (above).<a href="#appendix-A.4-24" class="pilcrow">¶</a></p>
<p id="appendix-A.4-25">In this case, the holder has decided not to disclose the last three
claims provided by the issuer (corresponding to <code>email</code>, <code>address</code>, and
<code>age_over_21</code>)<a href="#appendix-A.4-25" class="pilcrow">¶</a></p>
<p id="appendix-A.4-26">For each payload slot, the holder will provide one of two values as part
of the proof value.  For a disclosed payload, the holder will provide
the corresponding derived key.  For a non-disclosed payload, the holder
will provide the corresponding MAC value.<a href="#appendix-A.4-26" class="pilcrow">¶</a></p>
<p id="appendix-A.4-27">The final presented proof value is an array of octet strings.  The
contents are presentation header signature, followed by the issuer
signature, then the value disclosed by the holder for each payload.
This results in the following proof:<a href="#appendix-A.4-27" class="pilcrow">¶</a></p>
<span id="name-presentation-proof-base64ur"></span><figure id="figure-25">
          <div class="lang-wrapped sourcecode" id="appendix-A.4-28.1">
<pre>[
  "UT9Qo7y_J2XfsufwFwU1Dur8TMXmwbdy62KPeDbdLhXSmZpa0nbjqYN8risZU8q7rs
T13AboPy6aTp-TjYK8mw",
  "bpdUoU5cCf5UlM8jO39U_4E8RrSl2quc9umLfszFzbI",
  "gaF8-zHN7oogZRbuanajf0IjGuX2eRi0umMf5CSC9Yg",
  "Wy1J33l5qX6jjSDRhIIdeNA0Eo1f54JdhW90cuGgVCI",
  "R_NJq2y58bwJWFHPu4QQRXR0w_v-00W8Mk7QzPNYRpc",
  "FqzsvDIF2gRQC_Rh5Ws9MD4usaPRLvaE8S55LRPcG00",
  "rwQVbkklDBCsNdXVb3GCbBk4zWr6Ehu-QRioh7jVIXw",
  "ahYOdLdWr0Q0L429Lq0nZB3-hGYsi40Hh9w1M6vsfqI",
  "tnKqfUThyZgjUF_sdnlGQu9IY1w-QqDf0-OZnNgwgqIkZyfmzd_l9GB0i2AnOuDvWy
CObYxPCND2mbznfvTWMQ"
]

</pre>
</div>
<figcaption><a href="#figure-25" class="selfRef">Figure 25</a>:
<a href="#name-presentation-proof-base64ur" class="selfRef">Presentation proof (Base64url-Encoded)</a>
          </figcaption></figure>
<p id="appendix-A.4-29">The final presented JWP in compact serialization is:<a href="#appendix-A.4-29" class="pilcrow">¶</a></p>
<span id="name-presented-jwp-mac-h256-json"></span><figure id="figure-26">
          <div class="lang-wrapped sourcecode" id="appendix-A.4-30.1">
<pre>eyJhbGciOiJNQUMtSDI1NiIsImF1ZCI6Imh0dHBzOi8vcmVjaXBpZW50LmV4YW1wbGUuY
29tIiwibm9uY2UiOiJMOF9pQWh2TjBVRHFveHZRd0xOTVBmZnEtWk9zSUJxU29OdElOd2
1JeEhNIn0.eyJhbGciOiJNQUMtSDI1NiIsImhwYSI6IkVTMjU2IiwidHlwIjoiSlBUIiw
iaXNzIjoiaHR0cHM6Ly9pc3N1ZXIuZXhhbXBsZSIsImNsYWltcyI6WyJpYXQiLCJleHAi
LCJmYW1pbHlfbmFtZSIsImdpdmVuX25hbWUiLCJlbWFpbCIsImFkZHJlc3MiLCJhZ2Vfb
3Zlcl8yMSJdLCJwcmVzZW50YXRpb25fa2V5Ijp7Imt0eSI6IkVDIiwiY3J2IjoiUC0yNT
YiLCJ1c2UiOiJzaWduIiwieCI6IlVER1BQZEx2bTZ6YUpEMWN5NVRxSlQ0ak03cWlFanp
MMnhlX0pSNkhOVEkiLCJ5IjoiMWhDM2JvdllETjF1RW91U2pnZUVIdFMyWDlDd0N2T0o5
Y0JkcDZ1WVozZyJ9fQ.MTcxNDUyMTYwMA~MTcxNzE5OTk5OQ~IkRvZSI~IkpheSI~~~.U
T9Qo7y_J2XfsufwFwU1Dur8TMXmwbdy62KPeDbdLhXSmZpa0nbjqYN8risZU8q7rsT13A
boPy6aTp-TjYK8mw~bpdUoU5cCf5UlM8jO39U_4E8RrSl2quc9umLfszFzbI~gaF8-zHN
7oogZRbuanajf0IjGuX2eRi0umMf5CSC9Yg~Wy1J33l5qX6jjSDRhIIdeNA0Eo1f54Jdh
W90cuGgVCI~R_NJq2y58bwJWFHPu4QQRXR0w_v-00W8Mk7QzPNYRpc~FqzsvDIF2gRQC_
Rh5Ws9MD4usaPRLvaE8S55LRPcG00~rwQVbkklDBCsNdXVb3GCbBk4zWr6Ehu-QRioh7j
VIXw~ahYOdLdWr0Q0L429Lq0nZB3-hGYsi40Hh9w1M6vsfqI~tnKqfUThyZgjUF_sdnlG
Qu9IY1w-QqDf0-OZnNgwgqIkZyfmzd_l9GB0i2AnOuDvWyCObYxPCND2mbznfvTWMQ

</pre>
</div>
<figcaption><a href="#figure-26" class="selfRef">Figure 26</a>:
<a href="#name-presented-jwp-mac-h256-json" class="selfRef">Presented JWP (MAC-H256, JSON, Compact Serialization)</a>
          </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">This work was incubated in the DIF <a href="https://identity.foundation/working-groups/crypto.html">Applied Cryptography Working
Group</a>.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">We would like to thank
Alberto Solavagione
for his valuable contributions to this specification.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">The BBS examples were generated using the library at
<a href="https://github.com/mattrglobal/pairing_crypto">https://github.com/mattrglobal/pairing_crypto</a> .<a href="#appendix-B-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-C">
      <h2 id="name-document-history">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-C-1">[[ To be removed from the final specification ]]<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">-10<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-C-3.1">Clarify MAC issuance and presentation using new "payload slot"
nomenclature.<a href="#appendix-C-3.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-3.2">Define a new binary "Presentation Internal Representation" so that the
holder signature protects the entire presentation<a href="#appendix-C-3.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-3.3">Leverage the new "Holder Presentation Algorithm" to allow the holder
algorithm to be independent from the signature algorithm used by the
issuer<a href="#appendix-C-3.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-3.4">Redefine computation of the "Combined MAC Representation" to more
closely match the new Presentation Internal Representation.<a href="#appendix-C-3.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-3.5">Change the MAC algorithm to directly sign the binary Combined MAC
Representation rather than convert it to a JWS.<a href="#appendix-C-3.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-3.6">Do not unnecessarily hash the issuer protected header inside the
Combined MAC Representation, so that it can provide some manner of
domain separation.<a href="#appendix-C-3.6" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-3.7">Clarify how verifiers are to generate the Combined MAC Representation
from available information.<a href="#appendix-C-3.7" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-3.8">Provider step-by-step instructions for verification of a presentation<a href="#appendix-C-3.8" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-C-4">-09<a href="#appendix-C-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-C-5.1">Remove JSON serialization<a href="#appendix-C-5.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-5.2">Added CBOR (CPT) example to the appendix using SU-ES256<a href="#appendix-C-5.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-C-6">-08<a href="#appendix-C-6" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-C-7.1">Made some additional references normative.<a href="#appendix-C-7.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-7.2">Corrected SU-ES256 issuer protected header including private keys<a href="#appendix-C-7.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-C-8">-07<a href="#appendix-C-8" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-C-9.1">Changing primary editor<a href="#appendix-C-9.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-9.2">Update registry template for algorithms to account for integer CBOR
labels<a href="#appendix-C-9.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-9.3">Restylize initial registry entries for readability<a href="#appendix-C-9.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-9.4">Defer BBS key definition to <span>[<a href="#I-D.ietf-cose-bls-key-representations" class="cite xref">I-D.ietf-cose-bls-key-representations</a>]</span><a href="#appendix-C-9.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-9.5">Modify example generation to use <code>proof_key</code> and <code>presentation_key</code>
names<a href="#appendix-C-9.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-9.6">Change <code>proof_jwk</code> to <code>proof_key</code> and <code>presentation_jwk</code> to
<code>presentation_key</code> to better represent that the key may be JSON or
CBOR-formatted.<a href="#appendix-C-9.6" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-9.7">Moved the registry for <code>proof_key</code> and <code>presentation_key</code> to JWP where
they are defined.  Consolidated usage, purpose, and requirements from
algorithm usage under these definitions.<a href="#appendix-C-9.7" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-9.8">Combined <code>BBS-PROOF</code> into <code>BBS</code><a href="#appendix-C-9.8" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-C-10">-06<a href="#appendix-C-10" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-C-11.1">Update reference to new repository home<a href="#appendix-C-11.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-11.2">Fixed #77: Removed vestigial use of <code>presentation_header</code>.<a href="#appendix-C-11.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-11.3">Correct <code>pjwk</code> to <code>presentation_jwk</code><a href="#appendix-C-11.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-C-12">-05<a href="#appendix-C-12" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-C-13.1">Update of appendix describing MAC-H256 to now also be generated by the
build system from a common set of code and templates.<a href="#appendix-C-13.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-13.2">Update single use algorithm to use an array of octet values rather
than requiring splitting an octet buffer into parts during generation
of a presentation and during verification.<a href="#appendix-C-13.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-13.3">Update BBS algorithm description and examples to clarify the proof is
an array with a single octet string.<a href="#appendix-C-13.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-13.4">Update MAC algorithm to use an array of octet values for the proof,
rather than requiring splitting an octet buffer into parts.<a href="#appendix-C-13.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-13.5">Add new section on the Combined MAC Representation to clarify
operations are serving to recreate this octet string value.<a href="#appendix-C-13.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-13.6">Correct reference to the latest BBS draft.<a href="#appendix-C-13.6" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-13.7">SU and MAC families now use raw JWA rather than JWS and synthesized
headers<a href="#appendix-C-13.7" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-13.8">Change algorithms to not use base64url-encoding internally.
Algorithms are meant to operate on octets, while base64url-encoding is
used to represent those octets in JSON and compact serializations.<a href="#appendix-C-13.8" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-C-14">-04<a href="#appendix-C-14" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-C-15.1">Refactoring figures and examples to be built from a common set across
all three documents<a href="#appendix-C-15.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-15.2">Move single-use example appendix from JWP to JPA<a href="#appendix-C-15.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-15.3">Change algorithm from <code>BBS-DRAFT-5</code> to <code>BBS</code>, and from
<code>BBS-PROOF-DRAFT-5</code> to <code>BBS-PROOF</code><a href="#appendix-C-15.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-15.4">Update BBS ciphersuite ID to <code>BBS_BLS12381G1_XMD:SHA-256_SSWU_RO_</code><a href="#appendix-C-15.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-15.5">Update to draft 5 BLS key representations<a href="#appendix-C-15.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-C-16">-03<a href="#appendix-C-16" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-C-17.1">Improvements resulting from a full proofreading.<a href="#appendix-C-17.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-17.2">Populated IANA Considerations section.<a href="#appendix-C-17.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-17.3">Updated to use BBS draft -05.<a href="#appendix-C-17.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-17.4">Updated examples.<a href="#appendix-C-17.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-C-18">-02<a href="#appendix-C-18" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-C-19.1">Add new <code>BBS-DRAFT-3</code> and <code>BBS-PROOF-DRAFT-3</code> algorithms based on
draft-irtf-cfrg-bbs-signatures-03.<a href="#appendix-C-19.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-19.2">Remove prior <code>BBS-X</code> algorithm based on a particular implementation of
earlier drafts.<a href="#appendix-C-19.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-C-20">-01<a href="#appendix-C-20" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-C-21.1">Correct cross-references within group<a href="#appendix-C-21.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-21.2">Describe <code>issuer_header</code> and <code>presentation_header</code><a href="#appendix-C-21.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-21.3">Update BBS references to CFRG drafts<a href="#appendix-C-21.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-21.4">Rework reference to HMAC ( RFC2104 )<a href="#appendix-C-21.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-C-21.5">Remove ZKSnark placeholder<a href="#appendix-C-21.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-C-22">-00<a href="#appendix-C-22" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-C-23.1">Created initial working group draft based on
draft-jmiller-jose-json-proof-algorithms-01<a href="#appendix-C-23.1" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael B. Jones</span></div>
<div dir="auto" class="left"><span class="org">Self-Issued Consulting</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:michael_b_jones@hotmail.com" class="email">michael_b_jones@hotmail.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://self-issued.info/" class="url">https://self-issued.info/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David Waite</span></div>
<div dir="auto" class="left"><span class="org">Ping Identity</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dwaite+jwp@pingidentity.com" class="email">dwaite+jwp@pingidentity.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jeremie Miller</span></div>
<div dir="auto" class="left"><span class="org">Ping Identity</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jmiller@pingidentity.com" class="email">jmiller@pingidentity.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
